---
title: Math_Rev
author: yuli_Xia
date: 2025-03-20
---
# 第7章 微分方程

---

## 一阶常微分方程

一阶常微分方程是形如 $\frac{dy}{dx} = f(x, y)$ 的方程。根据其形式，可分为以下几类：

---

### 1. 可分离变量的方程

- **形式**: $\frac{dy}{dx} = \frac{g(x)}{h(y)}$
- **求解步骤**:
  1. 改写为 $h(y) \, dy = g(x) \, dx$
  2. 两边积分: $\int h(y) \, dy = \int g(x) \, dx + C$
  3. 若可能，解出 $y$

---

### 2. 齐次方程

- **形式**: $\frac{dy}{dx} = f\left(\frac{y}{x}\right)$
- **求解步骤**:
  1. 令 $v = \frac{y}{x}$，则 $y = v x$
  2. 代入得 $v + x \frac{dv}{dx} = f(v)$
  3. 整理为 $\frac{dv}{f(v) - v} = \frac{dx}{x}$
  4. 两边积分并回代求解

#### 判断是否为齐次方程

核心思想

简单来说，一个微分方程 $\frac{dy}{dx} = F(x, y)$ 是齐次方程，当且仅当右边的 $F(x, y)$ 可以写成只与 $\frac{y}{x}$ 有关的形式，即：

$$ F(x, y) = f\left( \frac{y}{x} \right) $$

我们的目标就是通过一些技巧，快速验证这件事能不能做到。

方法一：“一眼看穿”法（数次数法）

这是最快的方法，特别适合右边是多项式分式的微分方程。

规则
假设方程是 $\frac{dy}{dx} = \frac{g(x, y)}{h(x, y)}$，你只需要检查以下三点：
1. 分子 $g(x, y)$ 中**每一项**的“次数”是否**相同**？
2. 分母 $h(x, y)$ 中**每一项**的“次数”是否**相同**？
3. 分子和分母的“总次数”是否**相同**？

如果这三个条件都满足，那它就是齐次方程。

“次数”怎么算？
对于每一项，把 $x$ 和 $y$ 的指数加起来：
- $x^2$：次数是 $2$
- $y^3$：次数是 $3$
- $xy$：看成 $x^1 \cdot y^1$，次数是 $1 + 1 = 2$
- $x^2 y^3$：次数是 $2 + 3 = 5$
- $x$：次数是 $1$
- 常数 $5$：看成 $5 \cdot x^0 \cdot y^0$，次数是 $0$

例子
1. **判断 $\frac{dy}{dx} = \frac{x^2 + y^2}{xy}$**
   - 分子 $g(x, y) = x^2 + y^2$：
     - $x^2$：次数 $2$
     - $y^2$：次数 $2$
     - 各项次数相同，都是 $2$
   - 分母 $h(x, y) = xy$：
     - $xy$：次数 $1 + 1 = 2$
     - 只有一项，次数是 $2$
   - 分子总次数 $2$，分母总次数 $2$，相同！
   - **结论**：是齐次方程。

2. **判断 $\frac{dy}{dx} = \frac{x - 2y}{3x + y}$**
   - 分子 $x - 2y$：
     - $x$：次数 $1$
     - $2y$：次数 $1$
     - 各项次数相同，都是 $1$
   - 分母 $3x + y$：
     - $3x$：次数 $1$
     - $y$：次数 $1$
     - 各项次数相同，都是 $1$
   - 分子总次数 $1$，分母总次数 $1$，相同！
   - **结论**：是齐次方程。

3. **判断 $\frac{dy}{dx} = \frac{x^2 + y}{x}$**
   - 分子 $x^2 + y$：
     - $x^2$：次数 $2$
     - $y$：次数 $1$
     - 各项次数**不同**，可以直接停了
   - **结论**：不是齐次方程。

方法二：“万无一失”法（代数变形法）

这个方法稍慢但更通用，直接尝试把 $F(x, y)$ 变成 $f\left( \frac{y}{x} \right)$ 的形式。

规则
对于 $\frac{dy}{dx} = F(x, y)$，对 $F(x, y)$ 做代数操作：分子分母同时除以 $x$ 的最高次幂，然后检查结果是否只含 $\frac{y}{x}$ 和常数。

例子
1. **判断 $\frac{dy}{dx} = \frac{x^2 + y^2}{xy}$**
   - 最高次数是 $2$，分子分母同时除以 $x^2$：
   - $F(x, y) = \frac{x^2 + y^2}{xy}$
   - $= \frac{\frac{x^2 + y^2}{x^2}}{\frac{xy}{x^2}}$
   - $= \frac{\frac{x^2}{x^2} + \frac{y^2}{x^2}}{\frac{y}{x}}$
   - $= \frac{1 + \left( \frac{y}{x} \right)^2}{\frac{y}{x}}$
   - 结果只含常数 $1$ 和 $\frac{y}{x}$，成功！
   - **结论**：是齐次方程。

2. **判断 $\frac{dy}{dx} = \frac{x^2 + y}{x}$**
   - 分子最高次数是 $2$，试着除以 $x^2$：
   - $F(x, y) = \frac{x^2 + y}{x}$
   - $= \frac{\frac{x^2 + y}{x^2}}{\frac{x}{x^2}}$
   - $= \frac{1 + \frac{y}{x^2}}{\frac{1}{x}}$
   - 结果有 $\frac{y}{x^2}$ 和 $\frac{1}{x}$，不是 $\frac{y}{x}$ 的形式
   - **结论**：不是齐次方程。

快速判断流程

拿到 $\frac{dy}{dx} = F(x, y)$，按以下步骤：
1. **第一眼**：$F(x, y)$ 是否明显是 $f\left( \frac{y}{x} \right)$ 的形式？如 $\frac{dy}{dx} = \sin\left( \frac{y}{x} \right) + \left( \frac{y}{x} \right)^2$，直接判断为齐次。
2. **第二眼**：
   - 如果是分式 $\frac{g(x, y)}{h(x, y)}$：用**数次数法**，检查各项次数。
   - 如果不是分式或很复杂：用**代数变形法**，尝试凑出 $\frac{y}{x}$。
3. **严格证明**：需要时才用 $F(tx, ty) = t^k \cdot F(x, y)$。

---

### 3. 线性方程

- **形式**: $\frac{dy}{dx} + P(x) y = Q(x)$
- **求解步骤**:
  1. 计算积分因子 $\mu(x) = e^{\int P(x) \, dx}$
  2. 两边乘以 $\mu(x)$: $\mu(x) \frac{dy}{dx} + \mu(x) P(x) y = \mu(x) Q(x)$
  3. 左边为 $\frac{d}{dx} [\mu(x) y]$
  4. 积分: $\mu(x) y = \int \mu(x) Q(x) \, dx + C$
  5. 解出 $y$

---

### 4. 精确方程（全微分方程）

- **形式**: $M(x, y) \, dx + N(x, y) \, dy = 0$，且 $\frac{\partial M}{\partial y} = \frac{\partial N}{\partial x}$
- **求解步骤**:
  1. 验证精确性: $\frac{\partial M}{\partial y} = \frac{\partial N}{\partial x}$
  2. 找 $u(x, y)$ 使得 $\frac{\partial u}{\partial x} = M$，$\frac{\partial u}{\partial y} = N$
  3. 通解为 $u(x, y) = C$

---

## 可降阶的微分方程

类型一：$y^{(n)} = f(x)$ 型（最简单的一种）

- **特征**：方程一边是最高阶导数 $y^{(n)}$（如 $y''$ 或 $y'''$），另一边是只含自变量 $x$ 的函数 $f(x)$。  
  例如：  
  - $y'' = x + \sin(x)$  
  - $y''' = e^x$

- **核心思想**：这种方程本质上是“连续积分”的过程。既然 $y''$ 是 $y$ 的二阶导数，我们可以通过对 $y''$ 积分两次，逐步还原出 $y$。

- **降阶方法**：直接对两边逐次积分，每次积分降低一阶，并注意添加积分常数。

- **实战演练**：求解 $y'' = 6x$  
  1. **第一次降阶（求 $y'$）**：  
     对两边积分：  
     $$
     \int y'' \, dx = \int 6x \, dx
     $$  
     左边 $\int y'' \, dx = y'$，右边 $\int 6x \, dx = 3x^2$，加上积分常数：  
     $$
     y' = 3x^2 + C_1
     $$  
     现在，方程从二阶降为一阶。  

  2. **第二次降阶（求 $y$）**：  
     对 $y' = 3x^2 + C_1$ 再次积分：  
     $$
     \int y' \, dx = \int (3x^2 + C_1) \, dx
     $$  
     左边 $\int y' \, dx = y$，右边 $\int (3x^2 + C_1) \, dx = x^3 + C_1 x + C_2$，得：  
     $$
     y = x^3 + C_1 x + C_2
     $$  

  - **结论**：通解为 $y = x^3 + C_1 x + C_2$。一个二阶方程的通解应包含两个独立的任意常数 $C_1$ 和 $C_2$。

类型二：$F(x, y', y'') = 0$ 型（不显含 $y$，或称“缺 $y$ 型”）

- **特征**：方程中包含 $x$、$y'$、$y''$，但没有单独的 $y$。  
  例如：  
  - $x y'' + y' = 4x$  
  - $y'' + (y')^2 = x$

- **核心思想**：由于没有 $y$，我们可以将 $y'$ 视为一个新的未知函数，用 $p = y'$ 替代，$y''$ 就变成 $p$ 对 $x$ 的导数，从而降阶。

- **降阶方法**：  
  1. 令 $p = y'$，则 $y'' = \frac{dp}{dx}$。  
  2. 将 $p$ 和 $\frac{dp}{dx}$ 代入原方程，得到关于 $p$ 和 $x$ 的一阶方程。  
  3. 解出一阶方程得 $p = g(x, C_1)$。  
  4. 利用 $y' = p$，即 $\frac{dy}{dx} = g(x, C_1)$，再次积分求 $y$。

- **实战演练**：求解 $y'' - \frac{1}{x} y' = 0$（$x > 0$）  
  1. **识别特征**：有 $y''$、$y'$ 和 $x$，无 $y$，属于“缺 $y$ 型”。  

  2. **执行降阶**：  
     令 $p = y'$，则 $y'' = \frac{dp}{dx}$，代入得：  
     $$
     \frac{dp}{dx} - \frac{1}{x} p = 0
     $$  

  3. **解一阶方程**：  
     整理为 $\frac{dp}{dx} = \frac{p}{x}$，这是一个可分离变量方程：  
     $$
     \frac{dp}{p} = \frac{dx}{x}
     $$  
     两边积分：  
     $$
     \int \frac{dp}{p} = \int \frac{dx}{x}
     $$  
     得 $\ln |p| = \ln |x| + C$，即 $p = C_1 x$（$C_1$ 是常数）。  

  4. **回代求 $y$**：  
     $y' = p = C_1 x$，积分：  
     $$
     y = \int C_1 x \, dx = \frac{C_1}{2} x^2 + C_2
     $$  
     将 $\frac{C_1}{2}$ 重新记为 $C_1$（常数仍为任意常数），得通解：  
     $$
     y = C_1 x^2 + C_2
     $$

类型三：$F(y, y', y'') = 0$ 型（不显含 $x$，或称“缺 $x$ 型”）

- **特征**：方程中包含 $y$、$y'$、$y''$，但没有自变量 $x$。  
  例如：  
  - $y y'' - (y')^2 = 0$  
  - $y'' + 2 y' + y = 0$

- **核心思想**：没有 $x$，我们可以将 $y$ 视为新的“自变量”，通过链式法则将 $y''$ 表示为 $y'$ 和 $y$ 的函数，从而降阶。

- **降阶方法**：  
  1. 令 $p = y'$。  
  2. 用链式法则：$y'' = \frac{dp}{dx} = \frac{dp}{dy} \cdot \frac{dy}{dx} = p \cdot \frac{dp}{dy}$。  
  3. 代入原方程，得到关于 $p$ 和 $y$ 的一阶方程。  
  4. 解得 $p = h(y, C_1)$。  
  5. 利用 $p = \frac{dy}{dx}$，即 $\frac{dy}{dx} = h(y, C_1)$，分离变量并积分求 $y$。

- **实战演练**：求解 $y y'' = (y')^2$  
  1. **识别特征**：有 $y$、$y'$、$y''$，无 $x$，属于“缺 $x$ 型”。  

  2. **执行降阶**：  
     令 $p = y'$，则 $y'' = p \cdot \frac{dp}{dy}$，代入得：  
     $$
     y \cdot \left( p \cdot \frac{dp}{dy} \right) = p^2
     $$  

  3. **解一阶方程**：  
     整理为 $y p \frac{dp}{dy} = p^2$。若 $p = 0$，则 $y' = 0$，$y = C$ 是一个解。考虑 $p \neq 0$，两边除以 $p$：  
     $$
     y \frac{dp}{dy} = p
     $$  
     分离变量：$\frac{dp}{p} = \frac{dy}{y}$，积分：  
     $$
     \ln |p| = \ln |y| + C_1
     $$  
     得 $p = C_1 y$。  

  4. **回代求 $y$**：  
     $y' = p = C_1 y$，分离变量：  
     $$
     \frac{dy}{y} = C_1 \, dx
     $$  
     积分：$\ln |y| = C_1 x + C_2$，解得：  
     $$
     y = C_2 e^{C_1 x}
     $$  
     （$C_2 = e^{C_2}$ 为新常数）。

---

总结与对比

| 类型               | 特征                  | 降阶方法                              | 关键点               |
| ---------------- | ------------------- | --------------------------------- | ----------------- |
| $y^{(n)} = f(x)$ | 右边只有 $x$            | 直接逐次积分                            | 每次积分加新常数          |
| 缺 $y$ 型          | $F(x, y', y'') = 0$ | $p = y'$, $y'' = \frac{dp}{dx}$   | 解 $p(x)$ 后积分求 $y$ |
| 缺 $x$ 型          | $F(y, y', y'') = 0$ | $p = y'$, $y'' = p \frac{dp}{dy}$ | 链式法则是核心，解两步一阶方程   |

---

## 高阶常微分方程

高阶常微分方程包含二阶及以上导数。最常见的是线性常系数方程。

---

### 1. 高阶线性常系数齐次方程

- **形式**: $a_n y^{(n)} + a_{n-1} y^{(n-1)} + \cdots + a_1 y' + a_0 y = 0$
- **求解步骤**:
  1. 写出特征方程: $a_n r^n + a_{n-1} r^{n-1} + \cdots + a_1 r + a_0 = 0$
  2. 求特征根
  3. 根据根写通解:
     - 不同实根 $r_i$: $y = c_1 e^{r_1 x} + \cdots + c_n e^{r_n x}$
     - 重根 $r$（重数 $k$）: $(c_1 + c_2 x + \cdots + c_k x^{k-1}) e^{r x}$
     - 复根 $\alpha \pm i\beta$: $e^{\alpha x} (c_1 \cos \beta x + c_2 \sin \beta x)$

---

### 2. 高阶线性常系数非齐次方程

1. 识别方程

首先，确认方程是二阶线性非齐次微分方程。标准形式为：

$$
a(x) y'' + b(x) y' + c(x) y = f(x)
$$

其中，$a(x)$、$b(x)$、$c(x)$ 是已知函数，$f(x)$ 是非齐次项，且 $f(x) \neq 0$。

2. 求解对应的齐次方程

将非齐次项设为零，求解对应的齐次方程：

$$
a(x) y'' + b(x) y' + c(x) y = 0
$$

- **常系数情况**: 如果 $a$、$b$、$c$ 是常数，则通过特征方程求解：
  
$$
a r^2 + b r + c = 0
$$

  根据特征根的性质，齐次解 $y_h$ 的形式为：
  - 两个不等的实根 $r_1, r_2$:
    
$$
y_h = c_1 e^{r_1 x} + c_2 e^{r_2 x}
$$

  - 两个相等的实根:
    
$$
y_h = c_1 e^{r x} + c_2 x e^{r x}
$$

  - 复共轭根 $\alpha \pm i\beta$:
    
$$
y_h = e^{\alpha x} (c_1 \cos \beta x + c_2 \sin \beta x)
$$

- **变系数情况**: 如果 $a(x)$、$b(x)$、$c(x)$ 不是常数，可能需要使用约化阶法或鲁道夫数法等。

3. 寻找特解

为非齐次方程 $a(x) y'' + b(x) y' + c(x) y = f(x)$ 寻找一个特解 $y_p$。方法取决于 $f(x)$ 的形式：

- **待定系数法**:
  - 当 $f(x)$ 是多项式、指数函数、正弦或余弦函数的组合时适用。
  - 例如：
    - 若 $f(x) = k e^{m x}$，则试探 $y_p = A e^{m x}$（若 $m$ 不是特征根）。
    - 若 $f(x) = p_n(x)$（$n$ 次多项式），则试探 $y_p = q_n(x)$（$n$ 次多项式）。
    - 若 $f(x) = k \cos(m x)$ 或 $k \sin(m x)$，则试探 $y_p = A \cos(m x) + B \sin(m x)$。
  - 如果试探解与齐次解重合，则需要使用 $x$ 或更高次幂调整形式。
- **常数变异法**:
  - 适用于更一般的 $f(x)$。
  - 假设特解为 $y_p = u(x) y_1(x) + v(x) y_2(x)$，其中 $y_1(x)$、$y_2(x)$ 是齐次方程的两个线性无关解。
  - 建立方程组：
    
$$
\begin{cases}
    u' y_1 + v' y_2 = 0 \\
    u' y_1' + v' y_2' = \frac{f(x)}{a(x)}
    \end{cases}
$$

  - 解出 $u(x)$ 和 $v(x)$，从而得到 $y_p$。

4. 写出通解

非齐次方程的通解为齐次解与特解之和：

$$
y = y_h + y_p
$$

例如，若齐次解为 $y_h = c_1 y_1 + c_2 y_2$，则通解为：

$$
y = c_1 y_1 + c_2 y_2 + y_p
$$

**总结**：对于 $f(x) = e^{\lambda x}P_m (x)$ 的常系数非齐次微分方程

非齐次方程$y'' + py' + q = e^{\lambda x}P_m (x)$, 特解$y^*$ 的形式为 $x^k R_m (x)e^{\lambda x}$，**其中 $R_m (x)$ 与与 $P_m (x)$ 一样都是 $m$ 次多项式， $k$ 按特征方程的根的情况可能取 $0,1,2$ 。

(当 $\lambda$ 不是特征方程的根时取 $0$ ，是特征方程的单根时取 $1$ ，是重根时则取 $2$ )

| 特征方程的根                                | 特解形式                                                                                                  |
| ------------------------------------- | ----------------------------------------------------------------------------------------------------- |
| $\lambda^2 + p\lambda + q \neq 0$     | $y^* = x^0 R_m (x)e^{\lambda x}$, $y^{*'}(x)$ 和 $y^{*''}(x)$ 代入 $y'' + py' + q$ 不会消掉最高次项。             |
| $2\lambda + p \neq 0$取任意值             | $R_m (x) = b_0 x^m + b_1 x^{m-1} + \cdots + b_m$, $P_m (x) = b_0' x^m + b_1' x^{m-1} + \cdots + b_m'$ |
| $\lambda^2 + p\lambda + q = 0$        | $y^* = x R_m (x)e^{\lambda x}$, $y^{*'}(x)$ 和 $y^{*''}(x)$ 代入 $y'' + py' + q$ 只消掉最高次项。                |
| $p^2 - 4q > 0$, $2\lambda + p \neq 0$ | $R_m (x) = b_0 x^m + b_1 x^{m-1} + \cdots + b_m$,$P_m (x) = b_0' x^m + b_1' x^{m-1} + \cdots + b_m'$  |
| $\lambda^2 + p\lambda + q = 0$        | $y^* = x^2 R_m (x)e^{\lambda x}$, $y^{*'}(x)$ 和 $y^{*''}(x)$ 代入 $y'' + py' + q$ 消掉最高次和次高次项。           |
| $p^2 - 4q = 0$, $2\lambda + p = 0$    | $R_m (x) = b_0 x^m + b_1 x^{m-1} + \cdots + b_m$,$P_m (x) = b_0' x^m + b_1' x^{m-1} + \cdots + b_m'$  |
| 总结:                                   | $y^* = x^k R_m (x)e^{\lambda x}$                                                                      |
|                                       | $k = 0$ if roots don't contain $\lambda$                                                              |
|                                       | $k = 1$ if roots are single roots of the characteristic equation                                      |
|                                       | $k = 2$ if roots are repeated roots of the characteristic equation                                    |

**第一部分：模板的核心 —— “三件套” `y* = x^k * R_m(x) * e^(λx)`**

我们再来回顾一下这“三件套”各自的职责：

1.  **`e^(λx)` (基础形态)**:
    *   **来源**: 完全照抄右边 `f(x)` 里的指数部分。
    *   **职责**: 保证我们的猜测和目标函数在“物种”上是一致的。

2.  **`R_m(x)` (待定内容)**:
    *   **来源**: `R_m(x)` 是一个与 `P_m(x)` **次数相同**的、系数待定的**完整多项式**。如果 `P_m(x)` 是 `x²` (2次)，那么 `R_m(x)` 就必须设为 `Ax² + Bx + C` (完整的2次)。
    *   **职责**: 这是我们要“捏”出的具体形状，通过求解它的系数 `A, B, C...` 来精确匹配 `P_m(x)`。

3.  **`x^k` (修正补丁)**:
    *   **来源**: `k` 的值由 **“冲突检查”** 决定。
    *   **职责**: 这是整个模板的灵魂！它的作用是**保证我们的猜测代入方程左边后，不会被完全“消灭”成0**，确保有足够的“火力”去匹配右边的 `f(x)`。

**所以，整个模板使用的关键，就是一件事：如何正确地确定 `k` 的值。**

**第二部分：揭开表格的神秘面纱 —— `k` 的本质**

这张表格，其实就是在用不同的数学语言，反复强调**判断 `k` 的唯一标准**：

**`λ` 和特征方程 `r² + pr + q = 0` 的根是什么关系？**

我们一行一行地来破译这张表：

**第一行: `λ² + pλ + q ≠ 0`**
*   **翻译**: 把 `λ` 代入特征方程的左边，结果**不等于0**。
*   **这意味着什么?**: 这句话的定义就是：**`λ` 不是特征方程的根**。
*   **结论**: 没有冲突！
*   **对应的 k 值**: `k = 0`。
*   **特解形式**: `y* = x⁰ * R_m(x) * e^(λx) = R_m(x)e^(λx)`。
*   **表格里的备注**: “不会消掉最高次项”。
    *   **解释**: 这正是我们想要的！因为没有冲突，所以把 `y*` 代入左边 `y''+py'+qy` 后，`R_m(x)` 的最高次项 `Ax^m` 会“幸存”下来，这样我们才能让它等于右边 `P_m(x)` 的最高次项，从而解出系数 `A`。这是**最理想**的情况。

**第二行: `λ² + pλ + q = 0` 并且 `2λ + p ≠ 0`**
*   **翻译**: 把 `λ` 代入特征方程左边，结果**等于0**。这说明 **`λ` 是特征方程的根**。
*   **那 `2λ + p ≠ 0` 是什么意思？**
    *   我们把特征多项式看作一个函数 `F(r) = r² + pr + q`。
    *   它的导数是 `F'(r) = 2r + p`。
    *   所以 `2λ + p ≠ 0` 就意味着 `F'(λ) ≠ 0`。
    *   在代数里，如果一个数 `λ` 是多项式 `F(r)` 的根（`F(λ)=0`），但不是它导函数的根（`F'(λ)≠0`），那么 `λ` 就是这个多项式的**单根**。
*   **结论**: 发生冲突，`λ` 是特征方程的**单根**。
*   **对应的 k 值**: `k = 1`。
*   **特解形式**: `y* = x¹ * R_m(x) * e^(λx)`。
*   **表格里的备注**: “只消掉最高次项”。
    *   **解释**: 这句话是在告诉你为什么乘以 `x` 会起作用。因为 `k=1` 的修正，当你把 `y*` 代入左边时，`R_m(x)` 的最高次项 `Ax^m` 对应的部分会被精确地消掉，但**次高次项**会“幸存”下来，并变成新的“领头羊”，去匹配 `P_m(x)` 的最高次项。这个机制保证了我们依然能解出系数。

**第三行: `λ² + pλ + q = 0` 并且 `2λ + p = 0`**
*   **翻译**: `F(λ) = 0` 并且 `F'(λ) = 0`。
*   **这意味着什么?**: 在代数里，如果一个数 `λ` 既是多项式 `F(r)` 的根，也是它导函数的根，那么 `λ` 就是这个多项式的**重根（二重根）**。
*   **结论**: 发生严重冲突，`λ` 是特征方程的**重根**。
*   **对应的 k 值**: `k = 2`。
*   **特解形式**: `y* = x² * R_m(x) * e^(λx)`。
*   **表格里的备注**: “消掉最高次和次高次项”。
    *   **解释**: `k=2` 的修正威力更大。当你把 `y*` 代入左边，`R_m(x)` 的最高次和次高次项对应的部分都会被消掉，但**第三高的项**会“幸存”下来成为“领头羊”，去匹配 `P_m(x)` 的最高次项。

**你看，整个复杂的表格，说的就是 `k=0, 1, 2` 这一件事！** 那些 `p, q` 的条件，只是判断 `λ` 是不是根、是单根还是重根的数学工具而已。

 **第三部分：你的“瑞士军刀”使用手册**

现在，你可以把这张表浓缩成一个极其清晰、可操作的流程。以后遇到任何这种类型的题，你就拿出这本手册：

**目标方程**: `y'' + py' + qy = e^(λx) * P_m(x)`

**步骤1：识别“原料”**
*   从方程左边，确定 `p` 和 `q`。
*   从方程右边，确定 `λ`（指数的系数）和 `P_m(x)`（多项式），并记下其次数 `m`。

**步骤2：分析“冲突”——确定 `k`**
*   写出特征方程 `r² + pr + q = 0` 并解出它的根 `r₁, r₂`。
*   **核心判断**：
    *   如果 `λ` 不等于 `r₁` 也不等于 `r₂`  =>  **`k = 0`** (无冲突)
    *   如果 `λ` 等于其中一个根（比如`r₁`），但`r₁ ≠ r₂`  =>  **`k = 1`** (单根冲突)
    *   如果 `λ` 等于 `r₁`，并且 `r₁ = r₂` (重根) =>  **`k = 2`** (重根冲突)

**步骤3：写出“模板解” `y*`**
*   根据 `m` 和 `k`，写出 `y*` 的完整形式：
    `y* = x^k * (A_m x^m + A_{m-1} x^{m-1} + ... + A₁x + A₀) * e^(λx)`
    把 `A` 到 `A_m` 全都写出来，一个都不能少！

**步骤4：执行“体力活”**
*   计算 `y*'` 和 `y*''` (这一步需要细心)。
*   把 `y*`, `y*'`, `y*''` 代入原方程左边。
*   化简，合并同类项。

**步骤5：求解“系数”**
*   让化简后的左边，恒等于右边的 `e^(λx) * P_m(x)`。
*   通过对比 `x^m e^(λx)`, `x^(m-1) e^(λx)`... 各项的系数，建立一个关于 `A_₀, A₁, ...` 的方程组，并解出它们。

**步骤6：组装“最终答案”**
*   求出齐次解 `y_h` (你在步骤2已经求出特征根了，所以 `y_h` 很容易写)。
*   最终通解 `y = y_h + y*`。

现在，这个流程就是你的“模板”了。它把所有复杂的理论都浓缩在了**步骤2**的判断中，剩下的就是按部就班的计算。你完全可以信任这个流程，它会带你解决所有这类问题。

---

# 第8章 向量代数与空间解析几何

---

## 投影相关
### 1. 求向量在坐标轴的投影（标量投影）

向量的投影（标量投影）是指向量在某个坐标轴上的分量大小。由于坐标轴是正交的，向量在每个坐标轴上的投影就是其对应的坐标分量：

- 在 $x$ 轴上的投影：$a_x$
- 在 $y$ 轴上的投影：$a_y$
- 在 $z$ 轴上的投影：$a_z$
#### 推广：求一个向量在另一个向量上的投影

$$
\text{proj}_{\mathbf{b}} \mathbf{a} = \left(\frac{\mathbf{a} \cdot \mathbf{b}}{|\mathbf{b}|} \right) 
$$

其中，$\mathbf{a} \cdot \mathbf{b}$ 是向量 $\mathbf{a}$ 和 $\mathbf{b}$ 的点积，计算公式是：

$$
\mathbf{a} \cdot \mathbf{b} = a_1 b_1 + a_2 b_2 + a_3 b_3
$$

---

### 2. 求向量在坐标轴上的分向量（向量投影）

向量的分向量（向量投影）是指沿着某个坐标轴方向的向量，其大小等于该轴上的标量投影。分向量可以表示为：

- 在 $x$ 轴上的分向量：$(a_x, 0, 0)$
- 在 $y$ 轴上的分向量：$(0, a_y, 0)$
- 在 $z$ 轴上的分向量：$(0, 0, a_z)$

---

## 计算与两个向量均垂直的单位向量

假设两个向量是 $\mathbf{a} = (a_1, a_2, a_3)$ 和 $\mathbf{b} = (b_1, b_2, b_3)$。

**步骤 1：计算两个向量的叉积**
首先，计算向量 $\mathbf{a}$ 和 $\mathbf{b}$ 的叉积 $\mathbf{c} = \mathbf{a} \times \mathbf{b}$。叉积的结果是一个与 $\mathbf{a}$ 和 $\mathbf{b}$ 都垂直的向量。

叉积的公式是：

$$
\mathbf{c} = \mathbf{a} \times \mathbf{b} = \begin{vmatrix}
\hat{i} & \hat{j} & \hat{k} \\
a_1 & a_2 & a_3 \\
b_1 & b_2 & b_3
\end{vmatrix}
$$

也可以展开为：

$$
\mathbf{c} = (a_2 b_3 - a_3 b_2, a_3 b_1 - a_1 b_3, a_1 b_2 - a_2 b_1)
$$

 **步骤 2：计算结果向量的模**
接下来，计算向量 $\mathbf{c}$ 的模（大小）：

$$
|\mathbf{c}| = \sqrt{(a_2 b_3 - a_3 b_2)^2 + (a_3 b_1 - a_1 b_3)^2 + (a_1 b_2 - a_2 b_1)^2}
$$

 **步骤 3：将叉积结果归一化**
为了得到单位向量，我们需要将向量 $\mathbf{c}$ 归一化。归一化的公式是：

$$
\hat{\mathbf{c}} = \frac{\mathbf{c}}{|\mathbf{c}|}
$$

这就是与 $\mathbf{a}$ 和 $\mathbf{b}$ 同时垂直的单位向量。

**总结**
1. 计算叉积 $\mathbf{c} = \mathbf{a} \times \mathbf{b}$。
2. 计算向量 $\mathbf{c}$ 的模 $|\mathbf{c}|$。
3. 归一化向量 $\mathbf{c}$，得到单位向量 $\hat{\mathbf{c}}$。

---

## 给定三个点求平面方程

**步骤 1：设定三点**
假设给定的三点为 $P_1(x_1, y_1, z_1)$，$P_2(x_2, y_2, z_2)$，和 $P_3(x_3, y_3, z_3)$。

**步骤 2：计算两个向量**
首先，我们计算由这三点构成的两个向量。例如，我们可以计算：

- 向量 $\mathbf{v_1} = P_2 - P_1 = (x_2 - x_1, y_2 - y_1, z_2 - z_1)$
- 向量$\mathbf{v_2} = P_3 - P_1 = (x_3 - x_1, y_3 - y_1, z_3 - z_1)$

**步骤 3：计算法向量**
平面的法向量 $\mathbf{n}$ 可以通过这两个向量的叉积来得到：

$$
\mathbf{n} = \mathbf{v_1} \times \mathbf{v_2}
$$

叉积的公式是：

$$
\mathbf{n} = (n_1, n_2, n_3) = \begin{vmatrix}
\hat{i} & \hat{j} & \hat{k} \\
x_2 - x_1 & y_2 - y_1 & z_2 - z_1 \\
x_3 - x_1 & y_3 - y_1 & z_3 - z_1
\end{vmatrix}
$$

展开后，得到法向量：

$$
\mathbf{n} = (n_1, n_2, n_3) = \left( (y_2 - y_1)(z_3 - z_1) - (z_2 - z_1)(y_3 - y_1), (z_2 - z_1)(x_3 - x_1) - (x_2 - x_1)(z_3 - z_1), (x_2 - x_1)(y_3 - y_1) - (y_2 - y_1)(x_3 - x_1) \right)
$$

**步骤 4：写出平面方程**
平面方程的一般形式是：

$$
n_1 (x - x_1) + n_2 (y - y_1) + n_3 (z - z_1) = 0
$$

其中，$(n_1, n_2, n_3)$是平面的法向量，$(x_1, y_1, z_1)$ 是平面上已知的一个点。

通过将法向量的分量代入上面的平面方程，就可以得到过给定三点的平面方程。

---
## 求点到平面距离

点 $(x_0, y_0, z_0)$ 到平面 $ax + by + cz + d = 0$ 的距离 $D$ 可以通过以下公式计算：

$$
D = \frac{|ax_0 + by_0 + cz_0 + d|}{\sqrt{a^2 + b^2 + c^2}}
$$

这个公式的分子是平面方程在给定点处的绝对值，分母是平面法向量的模。

---

## 求点到直线距离

### 方法一：使用向量叉积

这种方法通过直线的方向向量和点到直线上某点的向量，利用叉积计算距离。

1. **确定直线的方向向量** $\vec{d}$
   - 如果直线由两个平面相交定义，方向向量可以通过两个平面的法向量的叉积计算得到。

2. **找到直线上的一点** $Q$
   - 通过解两个平面方程的联立方程组，求出直线上任意一点。

3. **计算向量 $\overrightarrow{PQ}$**
   - 即从点 $P$ 到直线上的点 $Q$ 的向量，表示为： 
   $$
   \overrightarrow{PQ} = Q - P
   $$

4. **计算叉积 $\overrightarrow{PQ} \times \vec{d}$**
   - 使用向量叉积公式计算 $\overrightarrow{PQ}$ 和 $\vec{d}$ 的叉积。

5. **计算距离**
   - 距离公式为：
   $$
   \text{distance} = \frac{|\overrightarrow{PQ} \times \vec{d}|}{|\vec{d}|}
   $$

其中 $\overrightarrow{PQ} \times \vec{d}$ 是叉积，$|\vec{d}|$ 是方向向量的模。

### 方法二：参数化直线并求最小距离

这种方法通过参数化直线，找到直线上距离点 $P$ 最近的点，然后计算距离。

1. **参数化直线**
   - 找到直线的参数方程： 
   $$
   \vec{r}(t) = \vec{Q} + t\vec{d}
   $$ 
   其中 $\vec{Q}$ 是直线上的一点，$\vec{d}$ 是方向向量。

2. **计算使距离最小的参数 $t$**
   - 点 $P$ 到直线上点 $\vec{r}(t)$ 的距离平方为：
   $$
   D(t) = |\vec{r}(t) - \vec{P}|^2
   $$

   - 求导 $D'(t) = 0$，得到：
   $$
   t = - \frac{\vec{d} \cdot (\vec{Q} - \vec{P})}{|\vec{d}|^2}
   $$

3. **代入 $t$ 找到直线最近的点 $Q'$**
   - $Q' = \vec{Q} + t\vec{d}$

4. **计算距离 $|\vec{P}Q'|$**
   - 计算点 $P$ 到 $Q'$ 的欧几里得距离。

---

## 直线的表示

* 对称式: (x - x₀)/m = (y - y₀)/n = (z - z₀)/p
* 参数式: { x = x₀ + mt, y = y₀ + nt, z = z₀ + pt }

在这两种形式里，(x₀, y₀, z₀) 是直线上一个点的坐标，而 (m, n, p) 是直线的方向向量。

---

### 参数方程

参数方程表示直线的基本形式为：

$$
x = x_0 + at, \quad y = y_0 + bt, \quad z = z_0 + ct
$$

其中 $(x_0, y_0, z_0)$ 是直线上的一点，$\langle a, b, c \rangle$ 是方向向量。求解步骤如下：

1. **确定直线上的一点**
   - 找到直线上的一个具体点 $(x_0, y_0, z_0)$。
   - 如果直线由两个平面交线定义，可以通过固定一个变量（例如令 $y = t$），代入平面方程，解出其他变量（如 $x$ 和 $z$）来求得一点。

2. **确定方向向量**
   - 找到直线的方向向量 $\langle a, b, c \rangle$。
   - 如果是两个平面的交线，**可以通过两个平面法向量的叉积计算方向向量**，或者根据直线的几何性质分析得出。

3. **写出参数方程**
   - 将步骤 1 中得到的点和步骤 2 中得到的方向向量代入参数方程的形式，写出完整的方程。

---

### 对称式方程
对称式方程的基本形式为：

$$
\frac{x - x_0}{a} = \frac{y - y_0}{b} = \frac{z - z_0}{c}
$$

其中 $(x_0, y_0, z_0)$ 是直线上的一点，$(a, b, c)$ 是方向向量。求解步骤如下：

1. 从参数方程转化
   - 以参数方程为基础，分别解出参数 $t$： 
   $$
   t = \frac{x - x_0}{a}, \quad t = \frac{y - y_0}{b}, \quad t = \frac{z - z_0}{c}
   $$
1. 等式相等
   - 将上一步骤的 $t$ 表示式视为相等，得到对称式方程：
   $$
   \frac{x - x_0}{a} = \frac{y - y_0}{b} = \frac{z - z_0}{c}
   $$

注意事项：
- **方向向量不为零**：在对称式方程中，如果方向向量的某个分量（如 $a, b$ 或 $c$）为零，则分量对应的等式需要特殊处理，可能退化为一个常数参数。
- **验证正确性**：无论是参数方程还是对称式方程，完成后应代入原始条件（如平面方程）验证，确保所得直线满足要求。

---

## 求$xOy$面上的一条双曲线绕坐标轴旋转后的曲面方程

**步骤 1：将双曲线方程转化为标准形式**
假设给定的双曲线方程为：
$$
Ax^2 + By^2 = C
$$

对方程进行标准化，得到标准形式：
$$
\frac{x^2}{a^2} - \frac{y^2}{b^2} = 1
$$

其中，$a$和$b$分别是双曲线的半轴。

**步骤 2：绕$x$轴旋转一周**
当曲线绕$x$轴旋转一周时，$x$坐标保持不变，$y$坐标和$z$坐标将形成旋转的圆。旋转后的曲面方程为：
$$
\frac{x^2}{a^2} - \frac{y^2 + z^2}{b^2} = 1
$$
其中，$y^2 + z^2$表示绕$x$轴旋转形成的圆的平方和。

**步骤 3：绕$y$轴旋转一周**
当曲线绕$y$轴旋转一周时，$y$坐标保持不变，$x$坐标和$z$坐标将形成旋转的圆。旋转后的曲面方程为：
$$
\frac{x^2 + z^2}{a^2} - \frac{y^2}{b^2} = 1
$$
其中，$x^2 + z^2$表示绕$y$轴旋转形成的圆的平方和。

---

## 求两曲面的交线在xOy面上的投影方程

**步骤 1：求解交线**
给定两个曲面的方程，首先通过代入法或消元法找到它们的交线。通过将其中一个曲面的变量（如$z$）从方程中消去，得到交线的方程。

**步骤 2：消去$z$变量**
由于我们只关心交线在$xOy$平面上的投影，因此需要消去$z$变量。通过将$z$从其中一个方程中解出，然后代入另一个方程来消去$z$。

**步骤 3：得到投影方程**
在消去$z$后，方程只剩下$x$和$y$的关系式，这就是交线在$xOy$平面上的投影方程。

**示例：**
1. 给定球面方程$x^2 + y^2 + z^2 = 9$与平面方程$x + z = 1$，通过消去$z$，得到交线在$xOy$面上的投影方程为：
$$
2x^2 - 2x + y^2 = 8
$$

2. 给定椭球面方程$x^2 + y^2 + 4z^2 = 1$与圆锥面方程$z^2 = x^2 + y^2$，通过消去$z$，得到交线在$xOy$面上的投影方程为：
$$
x^2 + y^2 = \frac{1}{5}
$$

---

## 常见立体几何图形

### **1. 球面 (Sphere)**

- **几何定义**：空间中到某一个定点（球心）的距离等于定长（半径）的所有点的集合。
- **标准方程**:  
    $$(x - x_0)^2 + (y - y_0)^2 + (z - z_0)^2 = R^2$$ 
    - **球心**: $(x_0, y_0, z_0)$ 
    - **半径**: $R$
- **最简形式** (球心在原点):  
    $$x^2 + y^2 + z^2 = R^2$$
- **如何形成**: 可以由一个**圆**或**半圆**绕其**直径**旋转一周形成。 
    - 例如，$xOy$ 平面上的圆 $x^2 + y^2 = R^2$ 绕 $x$ 轴或 $y$ 轴旋转一周。

---

### **2. 旋转椭球面 (Ellipsoid of Revolution)**

- **几何定义**：由椭圆绕其长轴或短轴旋转一周形成的曲面。
- **标准方程** (中心在原点): 
    - **绕 $z$ 轴旋转 (扁椭球或长椭球)**:  
        $$\frac{x^2}{a^2} + \frac{y^2}{a^2} + \frac{z^2}{c^2} = 1$$  
        (注意 $x$ 和 $y$ 的分母相同) 
        - 由 $xOz$ 平面上的椭圆 $\frac{x^2}{a^2} + \frac{z^2}{c^2} = 1$ 绕 $z$ 轴旋转得到。
    - **绕 $x$ 轴旋转**:  
        $$\frac{x^2}{a^2} + \frac{y^2}{b^2} + \frac{z^2}{b^2} = 1$$  
        (注意 $y$ 和 $z$ 的分母相同) 
        - 由 $xOy$ 平面上的椭圆 $\frac{x^2}{a^2} + \frac{y^2}{b^2} = 1$ 绕 $x$ 轴旋转得到。
- **推广 (一般椭球面)**: $$\frac{x^2}{a^2} + \frac{y^2}{b^2} + \frac{z^2}{c^2} = 1$$。它像一个被“压扁”或“拉长”的橄榄球。如果 $a, b, c$ 都不相等，它就不是旋转曲面。

---

### **3. 旋转抛物面 (Paraboloid of Revolution)**

- **几何定义**：由抛物线绕其对称轴旋转一周形成的曲面。形状像一个“碗”或雷达天线。
- **标准方程** (顶点在原点): 
    - **绕 $z$ 轴旋转**:  
        $$x^2 + y^2 = 2pz \quad \text{(开口朝 $z$ 轴正向)}$$  
        或  
        $$\frac{x^2}{a^2} + \frac{y^2}{a^2} = \frac{z}{c}$$  
        (注意 $x$ 和 $y$ 的平方项系数相同，而 $z$ 是一次项) 
        - 由 $xOz$ 平面上的抛物线 $x^2 = 2pz$ 绕 $z$ 轴旋转得到。
    - **绕 $x$ 轴旋转**:  
        $$y^2 + z^2 = 2px \quad \text{(开口朝 $x$ 轴正向)}$$
- **推广 (椭圆抛物面)**: $$\frac{x^2}{a^2} + \frac{y^2}{b^2} = z$$。它的水平切面是椭圆。

---

### **4. 旋转双曲面 (Hyperboloid of Revolution)**

这是由双曲线旋转得到的，根据旋转轴的不同，会形成两种完全不同的曲面。

#### **(a) 单叶旋转双曲面 (One-Sheet Hyperboloid)**

- **几何特征**: 整个曲面是**连通**的，像一个“小蛮腰”或者发电厂的冷却塔。
- **标准方程** (中心在原点): 
    - **绕 $z$ 轴旋转**:  
        $$\frac{x^2}{a^2} + \frac{y^2}{a^2} - \frac{z^2}{c^2} = 1$$  
        (两个正的平方项系数相同，一个是负的) 
        - 由 $xOz$ 平面上的双曲线 $\frac{x^2}{a^2} - \frac{z^2}{c^2} = 1$ 绕其**虚轴** ($z$ 轴) 旋转得到。
- **如何形成**: 由双曲线绕其**不相交的对称轴（虚轴）** 旋转形成。

#### **(b) 二叶旋转双曲面 (Two-Sheet Hyperboloid)**

- **几何特征**: 曲面由**两个分离的部分**组成，像两个背对背的“碗”。
- **标准方程** (中心在原点): 
    - **绕 $z$ 轴旋转**:  
        $$-\frac{x^2}{a^2} - \frac{y^2}{a^2} + \frac{z^2}{c^2} = 1 \quad \text{或者} \quad \frac{x^2}{a^2} + \frac{y^2}{a^2} - \frac{z^2}{c^2} = -1$$  
        (一个正的平方项，两个负的平方项且系数相同) 
        - 由 $xOz$ 平面上的双曲线 $\frac{z^2}{c^2} - \frac{x^2}{a^2} = 1$ 绕其**实轴** ($z$ 轴) 旋转得到。
- **如何形成**: 由双曲线绕其**相交的对称轴（实轴）**旋转形成。

---

### **5. 圆锥面 (Circular Cone)**

- **几何定义**：由一条过原点（或顶点）的直线绕某一个坐标轴旋转形成。
- **标准方程** (顶点在原点): 
    - **绕 $z$ 轴旋转**:  
        $$x^2 + y^2 = c^2 z^2 \quad \text{或者} \quad \frac{x^2}{a^2} + \frac{y^2}{a^2} = \frac{z^2}{c^2}$$  
        (三个平方项，一边两个正的系数相同，另一边一个正的) 
        - 由 $xOz$ 平面上的直线 $x = c z$ 绕 $z$ 轴旋转得到。
- **推广 (椭圆锥面)**: $$\frac{x^2}{a^2} + \frac{y^2}{b^2} = z^2$$。它的水平切面是椭圆。

---

### **6. 柱面 (Cylinder)**

这是比较特殊的一类，它的方程中**只含有两个变量**。

- **几何特征**：一条二维曲线，沿着**缺失变量**的坐标轴方向无限平移生成的曲面。
- **标准方程示例**: 
    - **圆柱面**: $$x^2 + y^2 = R^2$$ 
        - 这是 $xOy$ 平面上的一个圆，沿着**缺失的 $z$ 轴**方向无限拉伸形成的，像一根无限长的管子。
    - **抛物柱面**: $$y = a x^2$$ 
        - 这是 $xOy$ 平面上的抛物线，沿着**缺失的 $z$ 轴**方向无限平移形成的，像一个U形的槽。
    - **双曲柱面**: $$\frac{x^2}{a^2} - \frac{y^2}{b^2} = 1$$ 
        - $xOy$ 平面上的双曲线，沿着**缺失的 $z$ 轴**拉伸。
    - **椭圆柱面**: $$\frac{x^2}{a^2} + \frac{y^2}{b^2} = 1$$ 
        - $xOy$ 平面上的椭圆，沿着**缺失的 $z$ 轴**拉伸。

---

# 第9章 多元函数微分法及其应用

---

## 二元初等函数求极限

### 证明极限的存在性

**路径法**
1. **确定函数和研究点**  
   给定二元函数 $f(x, y)$ 和点 $(a, b)$，我们需要判断 $\lim_{(x, y) \to (a, b)} f(x, y)$ 是否存在。

2. **选择路径**  
   选择不同的路径接近点 $(a, b)$。常见的路径包括：  
   - 直线路径：例如，$y = kx + m$，其中 $k$ 和 $m$ 是常数。  
   - 抛物线路径：例如，$y = x^2$。  
   - 其他参数化路径：例如，$x = a + t$, $y = b + t^2$，其中 $t \to 0$。

3. **计算沿路径的极限**  
   对于每条选择的路径，用参数 $t$ 表示路径，计算 $\lim_{t \to 0} f(x(t), y(t))$.
    **注意：** 如果函数沿着某条路径趋近某点时极限值为无穷大，那么它在这条路径上无法收敛到一个有限值。而多变量函数极限存在的条件是所有路径都必须趋近于同一个有限值。
    **只要有一条路径上函数发散到无穷大，整体极限就不可能存在，无论其他路径上的行为如何（无论是趋近于有限值还是也发散）。**

4. **比较极限值**  
   - 如果存在两条路径，使得沿这两条路径接近 $(a, b)$ 时，$f(x, y)$ 的极限值不同，则 $\lim_{(x, y) \to (a, b)} f(x, y)$ 不存在。  
   - 如果沿所有选择的路径，$f(x, y)$ 的极限值都相同，记为 $L$，则极限可能存在，但这并不足以证明极限一定存在，还需进一步验证，例如使用极限的定义或其他方法。

需要注意的是，路径法可以有效证明极限不存在，但不能单独证明极限存在。如果沿不同路径得到的极限值不同，则极限一定不存在；但如果所有路径的极限值相同，仍需其他方法（如 $\epsilon$-$\delta$ 定义）来确认极限的存在性。

---

## 空间中质点运动相关

**给定位置函数：** 质点在空间中的位置由向量函数 $\mathbf{r}(t)$ 描述，其中 $t$ 表示时间。通常，$\mathbf{r}(t)$ 可以表示为：

$$\mathbf{r}(t) = x(t)\mathbf{i} + y(t)\mathbf{j} + z(t)\mathbf{k}$$

其中，$x(t)$，$y(t)$，$z(t)$ 分别是质点在 $x, y, z$ 方向上的位置分量，$\mathbf{i}, \mathbf{j}, \mathbf{k}$ 是沿 $x, y, z$ 轴的单位向量。

---

### 1. 速度向量

速度向量 $\mathbf{v}(t)$ 是位置向量 $\mathbf{r}(t)$ 对时间 $t$ 的一阶导数，表示质点位置随时间的变化率。

$$
\mathbf{v}(t) = \frac{d\mathbf{r}}{dt} = \frac{d}{dt} [x(t)\mathbf{i} + y(t)\mathbf{j} + z(t)\mathbf{k}] = \frac{dx}{dt}\mathbf{i} + \frac{dy}{dt}\mathbf{j} + \frac{dz}{dt}\mathbf{k}
$$

通常也记为：

$\mathbf{v}(t) = \mathbf{r}'(t) = v_x(t)\mathbf{i} + v_y(t)\mathbf{j} + v_z(t)\mathbf{k}$

其中，$v_x(t) = \frac{dx}{dt}$，$v_y(t) = \frac{dy}{dt}$，$v_z(t) = \frac{dz}{dt}$ 分别是速度向量在 $x, y, z$ 方向上的分量。

---

### 2. 加速度向量

加速度向量 $\mathbf{a}(t)$ 是速度向量 $\mathbf{v}(t)$ 对时间 $t$ 的一阶导数，或者位置向量 $\mathbf{r}(t)$ 对时间 $t$ 的二阶导数，表示质点速度随时间的变化率。

$$\mathbf{a}(t) = \frac{d\mathbf{v}}{dt} = \frac{d^2\mathbf{r}}{dt^2} = \frac{d}{dt} [\frac{dx}{dt}\mathbf{i} + \frac{dy}{dt}\mathbf{j} + \frac{dz}{dt}\mathbf{k}] = \frac{d^2x}{dt^2}\mathbf{i} + \frac{d^2y}{dt^2}\mathbf{j} + \frac{d^2z}{dt^2}\mathbf{k}$$

通常也记为：

$$\mathbf{a}(t) = \mathbf{v}'(t) = \mathbf{r}''(t) = a_x(t)\mathbf{i} + a_y(t)\mathbf{j} + a_z(t)\mathbf{k}$$

其中，$a_x(t) = \frac{d^2x}{dt^2}$，$a_y(t) = \frac{d^2y}{dt^2}$，$a_z(t) = \frac{d^2z}{dt^2}$ 分别是加速度向量在 $x, y, z$ 方向上的分量。

---

### **3. 任意时刻的速率**

速率是速度向量的大小（模长），是一个标量，表示质点运动的快慢。

$$\text{速率} = |\mathbf{v}(t)| = \sqrt{[v_x(t)]^2 + [v_y(t)]^2 + [v_z(t)]^2} = \sqrt{(\frac{dx}{dt})^2 + (\frac{dy}{dt})^2 + (\frac{dz}{dt})^2}$$

---

## 求曲线在某点处切线及法平面方程

**给定条件：**

*   空间曲线 $\mathcal{C}$，通常以参数方程 $\mathbf{r}(t) = x(t)\mathbf{i} + y(t)\mathbf{j} + z(t)\mathbf{k}$ 的形式给出。
*   曲线上一点 $P_0$，对应参数值为 $t_0$，即 $P_0 = \mathbf{r}(t_0) = (x(t_0), y(t_0), z(t_0))$。

---

**求解步骤：**

**1. 求切向量 $\mathbf{v}$**
曲线 $\mathcal{C}$ 在点 $P_0$ 处的切向量 $\mathbf{v}$ 由位置向量函数 $\mathbf{r}(t)$ 对参数 $t$ 求导，并在 $t = t_0$ 处取值得到。

$$ \mathbf{v}(t) = \mathbf{r}'(t) = \frac{d\mathbf{r}}{dt} = \frac{dx}{dt}\mathbf{i} + \frac{dy}{dt}\mathbf{j} + \frac{dz}{dt}\mathbf{k} $$

将 $t = t_0$ 代入 $\mathbf{v}(t)$，得到在点 $P_0$ 处的切向量 $\mathbf{v} = \mathbf{v}(t_0) = \mathbf{r}'(t_0) = \langle x'(t_0), y'(t_0), z'(t_0) \rangle$。

**注意：**  如果 $\mathbf{r}'(t_0) = \mathbf{0}$，则需要考虑更高阶的导数或者曲线的特殊性质，此处我们假设 $\mathbf{r}'(t_0) \neq \mathbf{0}$，即曲线在该点存在非零切向量。

**2. 写出切线方程**
切线 $L$ 是通过点 $P_0(x_0, y_0, z_0)$，方向向量为 $\mathbf{v} = \langle a, b, c \rangle = \langle x'(t_0), y'(t_0), z'(t_0) \rangle$ 的直线，其中 $x_0 = x(t_0), y_0 = y(t_0), z_0 = z(t_0)$，$a = x'(t_0), b = y'(t_0), c = z'(t_0)$。

切线 $L$ 的方程可以表示为以下形式：

*   **参数方程：**
   $$ \begin{cases} x = x_0 + at \\ y = y_0 + bt \\ z = z_0 + ct \end{cases} $$
   其中，$t$ 为参数。

*   **对称式方程：** （当 $a, b, c$ 均不为零时）
   $$ \frac{x - x_0}{a} = \frac{y - y_0}{b} = \frac{z - z_0}{c} $$
   如果某个方向向量分量为零，例如 $a = 0$，则对称式方程应理解为 $x - x_0 = 0$ 且 $\frac{y - y_0}{b} = \frac{z - z_0}{c}$。

**3. 写出法平面方程**
法平面 $\Pi$ 是通过点 $P_0(x_0, y_0, z_0)$，且以切向量 $\mathbf{v} = \langle a, b, c \rangle$ 为法向量的平面。

法平面 $\Pi$ 的方程为：

$$ a(x - x_0) + b(y - y_0) + c(z - z_0) = 0 $$

展开后得到一般式方程：

$$ ax + by + cz - (ax_0 + by_0 + cz_0) = 0 $$

或

$$ ax + by + cz = ax_0 + by_0 + cz_0 $$

---
## 函数的全微分

---

### 全微分的定义

全微分是函数改变量的主要线性部分。

1.  **二元函数:**
    如果函数 $z = f(x, y)$ 在点 $(x, y)$ 处可微，则其全微分为：
    $dz = \frac{\partial z}{\partial x} dx + \frac{\partial z}{\partial y} dy$
    或者写成：$df(x, y) = f_x(x, y) dx + f_y(x, y) dy$

2.  **三元函数:**
    如果函数 $u = f(x, y, z)$ 在点 $(x, y, z)$ 处可微，则其全微分为：
    $du = \frac{\partial u}{\partial x} dx + \frac{\partial u}{\partial y} dy + \frac{\partial u}{\partial z} dz$
    或者写成：$df(x, y, z) = f_x(x, y, z) dx + f_y(x, y, z) dy + f_z(x, y, z) dz$

3.  **推广:**
    对于 n 元函数 $u = f(x_1, x_2, \dots, x_n)$，其全微分为：$du = \sum_{i=1}^{n} \frac{\partial u}{\partial x_i} dx_i$

---

### 求全微分的通用解法

求解函数 $u = f(x_1, x_2, \dots, x_n)$ 的全微分，通常遵循以下步骤：

1.  **确定函数的自变量:** 明确函数依赖于哪些变量（例如 $x, y, z$）。
2.  **计算所有偏导数:** 分别计算函数 $u$ 对每一个自变量 $x_i$ 的偏导数 $\frac{\partial u}{\partial x_i}$。在求某个偏导数（如 $\frac{\partial u}{\partial x_k}$）时，将其他所有自变量（$x_j, j \neq k$）视为常数。
3.  **构建全微分表达式:** 将计算得到的各偏导数代入全微分的定义公式：
    $$du = \frac{\partial u}{\partial x_1} dx_1 + \frac{\partial u}{\partial x_2} dx_2 + \dots + \frac{\partial u}{\partial x_n} dx_n$$
4.  **(可选) 化简表达式:** 对得到的结果进行代数化简。

---

## 多元复合函数求导链式法则

链式法则是计算复合函数导数的基本方法。当一个函数的自变量本身也是其他变量的函数时，我们需要使用链式法则来求最终函数对底层自变量的导数（全导数或偏导数）。

---

### 中间变量依赖于单个最终变量

设函数 $u = f(y_1, y_2, \dots, y_n)$，而每个中间变量 $y_i$ 都是变量 $x$ 的函数，即 $y_i = y_i(x)$ for $i=1, \dots, n$。我们想求 $u$ 对 $x$ 的 **全导数** $\frac{du}{dx}$。

**通用公式:**
$$
\frac{du}{dx} = \frac{\partial u}{\partial y_1} \frac{dy_1}{dx} + \frac{\partial u}{\partial y_2} \frac{dy_2}{dx} + \dots + \frac{\partial u}{\partial y_n} \frac{dy_n}{dx} = \sum_{i=1}^{n} \frac{\partial u}{\partial y_i} \frac{dy_i}{dx}
$$

**例：**

1.  **函数 $u = f(x, y)$，其中 $y = y(x)$**
    此时，$u$ 不仅通过 $y$ 依赖于 $x$，还可能直接显式地依赖于 $x$。求 $u$ 对 $x$ 的全导数 $\frac{du}{dx}$。
    公式为：
    $$
    \frac{du}{dx} = \frac{\partial f}{\partial x} + \frac{\partial f}{\partial y} \frac{dy}{dx}
    $$
    注意：这里的 $\frac{\partial f}{\partial x}$ (或者记作 $f_x$) 是指 $f$ 对其**第一个**参数（显式 $x$）求偏导，将 $y$ 暂时视为与 $x$ 无关的变量。

2.  **函数 $u = f(x, y, z)$，其中 $y = y(x), z = z(x)$**
    求 $u$ 对 $x$ 的全导数 $\frac{du}{dx}$。公式为：
    $$
    \frac{du}{dx} = \frac{\partial f}{\partial x} + \frac{\partial f}{\partial y} \frac{dy}{dx} + \frac{\partial f}{\partial z} \frac{dz}{dx}
    $$
    同样，$\frac{\partial f}{\partial x}$ 是指 $f$ 对其显式变量 $x$ 求偏导，将 $y$ 和 $z$ 暂时视为与 $x$ 无关。

---

### 中间变量依赖于多个最终变量

设函数 $u = f(x, y, \dots)$，而中间变量 $x, y, \dots$ 都是多个变量 $s, t, \dots$ 的函数，例如 $x = x(s, t)$, $y = y(s, t)$。我们想求 $u$ 对 $s$ 或 $t$ 的 **偏导数** $\frac{\partial u}{\partial s}$ 和 $\frac{\partial u}{\partial t}$。

**以 $u = f(x, y)$, $x = x(s, t)$, $y = y(s, t)$ 为例：**

* 求 $u$ 对 $s$ 的偏导数：
    $$
    \frac{\partial u}{\partial s} = \frac{\partial u}{\partial x} \frac{\partial x}{\partial s} + \frac{\partial u}{\partial y} \frac{\partial y}{\partial s}
    $$

* 求 $u$ 对 $t$ 的偏导数：
    $$
    \frac{\partial u}{\partial t} = \frac{\partial u}{\partial x} \frac{\partial x}{\partial t} + \frac{\partial u}{\partial y} \frac{\partial y}{\partial t}
    $$

---

## 多元函数求导

**问题一：函数关系是“显”还是“隐”？**

*   **“显函数” (Explicit Function)**：函数关系非常清晰，因变量（如`u`或`z`）被明确地表示为自变量（如`x`, `y`）的表达式。
    *   **形式**：`u = f(x, y, z, ...)`
    *   **例子**：`z = x² + sin(xy)` 或者我们上一道题 `u = e^(ax)(y-z) / (a²+1)`

*   **“隐函数” (Implicit Function)**：变量们都“纠缠”在一起，没有谁被单独解出来。
    *   **形式**：`F(x, y, z, ...) = 0`
    *   **例子**：`x² + y² + z² = 1` 或者 `z³ - 3xyz = a³`

接下来，根据“显”或“隐”，我们走不同的分支：

**分支一：如果函数是“显函数” `u = f(...)`**

这时，你要问自己第二个问题：

**问题二：函数 `u` 的自变量们，它们自己是独立的，还是别人的“提线木偶”？**

*   **情况A：自变量们都是独立的 (求偏导数)**
    *   **场景**：题目直接让你求 `∂u/∂x`, `∂u/∂y` ...
    *   **解读**：这是在问 `u` 沿着某个坐标轴方向的“坡度”。求对 `x` 的偏导时，`y`, `z` 等都是“木头人”，是常数。
    *   **方法**：**直接求偏导**。这就是我们最开始学的，用我们的“总心法”——“求谁的偏导，就把其他变量当常数”。
    *   **例子**：求 `u = x² + sin(xy)` 的 `∂u/∂x`。

*   **情况B：自变量们本身也是另一个变量（比如`t`）的函数 (求全导数)**
    *   **场景**：`u = f(x, y, z)`，而 `x = g(t)`, `y = h(t)`, `z = k(t)`。题目让你求 `du/dt`。
    *   **解读**：`t` 是最终的“总司令”，它的变化会通过 `x, y, z` 三条路径影响 `u`。我们要求的是**总影响力**。
    *   **方法**：**使用复合函数的链式法则（全导数公式）**。
        `du/dt = (∂u/∂x)(dx/dt) + (∂u/∂y)(dy/dt) + (∂u/∂z)(dz/dt)`
    *   **例子**：我们做过的那道 `u = e^(ax)(y-z) / (a²+1)`，其中 `y=asin(x), z=cos(x)`，求 `du/dx`。这里最终的自变量是 `x`，它通过三条路径影响`u`。

**分支二：如果函数是“隐函数” `F(...) = 0`**

这时，你要问自己第三个问题：

**问题三：这个隐函数关系是由单个方程，还是由一个方程组确定的？**

*   **情况C：由单个方程 `F(x, y, z) = 0` 确定 (隐函数求导)**
    *   **场景**：给你一个方程，让你求 `∂z/∂x` 或 `dy/dx`。
    *   **解读**：方程已经暗示了变量之间的依赖关系（比如`z`是`x,y`的函数）。
    *   **方法**：有两种选择，效果一样，看你个人喜好。
        1.  **公式法（强烈推荐）**：这是“快捷方式”，最不容易出错。
            `∂z/∂x = - (∂F/∂x) / (∂F/∂z)`
            `∂z/∂y = - (∂F/∂y) / (∂F/∂z)`
        2.  **两边直接求导**：对方程 `F=0` 的两边直接对某个变量（如`x`）求导，时刻记住链式法则（凡是遇到`z`，就要乘以一个`∂z/∂x`），然后解出`∂z/∂x`。
    *   **例子**：`z³ - 3xyz = a³`，求 `∂z/∂x`。

*   **情况D：由方程组确定 (隐函数组求导)**
    *   **场景**：给你 `{ F(x, y, u, v) = 0, G(x, y, u, v) = 0 }`，让你求 `∂u/∂x`, `∂v/∂x` 等。
    *   **解读**：这是最综合的情况。方程组确定了 `u` 和 `v` 是 `x` 和 `y` 的函数。
    *   **方法**：**只能用“两边求导”法，没有直接的公式！**
        1.  把方程组里的**每一个方程**的两边，都对同一个自变量（比如`x`）求偏导。
        2.  这样你会得到一个关于未知导数（比如`∂u/∂x` 和 `∂v/∂x`）的**线性方程组**。
        3.  解这个线性方程组，得到最终答案。
    *   **例子**：我们刚刚做的那道 `{z = x²+y², x²+2y²+3z²=20}`，求 `dy/dx, dz/dx`。

**总结与实战演练**

我们来回顾一下你感到困惑的那些问题，看看它们分别属于哪个类别：

1.  **`u = e^(ax)(y-z)/(a²+1)`，而 `y=asin(x), z=cos(x)`，求 `du/dx`。**
    *   **分析**：显函数，但它的自变量 `y,z` 都是最终自变量 `x` 的函数。
    *   **决策**：情况 B，使用复合函数链式法则（全导数公式）。

2.  **`x + 2y + z - 2√(xyz) = 0`，求 `∂z/∂x`。**
    *   **分析**：隐函数，由单个方程确定。
    *   **决策**：情况 C，使用公式 `∂z/∂x = -Fx/Fz` 最方便。

3.  **`z³ - 3xyz = a³`，求 `∂²z/∂x∂y`。**
    *   **分析**：隐函数，单个方程，但要求**高阶**导数。
    *   **决策**：第一步求一阶导 `∂z/∂y`，属于情况 C，可以用公式法。第二步求高阶导，对 `∂z/∂y` 的表达式求 `∂/∂x`，这里没有固定公式，需要硬算。或者用更巧妙的“对中间结果方程连续求导”，这本质上是“两边求导”法的升级应用。

4.  **`{z = x²+y², x²+2y²+3z²=20}`，求 `dy/dx, dz/dx`。**
    *   **分析**：隐函数，由方程组确定。
    *   **决策**：情况 D，必须用“两边求导”法，对两个方程都求导，然后解方程组。

请记住，**所有这些方法的根源都是链式法则**。公式法只是链式法则的一个便捷推论。当你彻底理解了这一点，你就不会再“晕”了，而是能灵活地选择最顺手的工具来解决问题。

---

## 空间曲线在某点处的切线与法平面方程

假设空间曲线 $C$ 由两个曲面方程的交线给出：
$$
\begin{cases}
F(x, y, z) = 0 \\
G(x, y, z) = 0
\end{cases}
$$
并且我们需要求曲线 $C$ 在其上一点 $P_0(x_0, y_0, z_0)$ 处的切线和法平面方程。

---

**步骤如下：**

1.  **计算梯度向量（曲面法向量）：**
    * 计算曲面 $F(x, y, z) = 0$ 在点 $P_0$ 处的梯度向量 $\nabla F(P_0)$：
        $$
        \nabla F(P_0) = \left( \frac{\partial F}{\partial x}, \frac{\partial F}{\partial y}, \frac{\partial F}{\partial z} \right) \bigg|_{(x_0, y_0, z_0)} = (F_x, F_y, F_z)_{P_0}
        $$
        这个向量 $\mathbf{n}_1 = \nabla F(P_0)$ 是曲面 $F=0$ 在点 $P_0$ 的一个法向量。
    * 计算曲面 $G(x, y, z) = 0$ 在点 $P_0$ 处的梯度向量 $\nabla G(P_0)$：
        $$
        \nabla G(P_0) = \left( \frac{\partial G}{\partial x}, \frac{\partial G}{\partial y}, \frac{\partial G}{\partial z} \right) \bigg|_{(x_0, y_0, z_0)} = (G_x, G_y, G_z)_{P_0}
        $$
        这个向量 $\mathbf{n}_2 = \nabla G(P_0)$ 是曲面 $G=0$ 在点 $P_0$ 的一个法向量。

2.  **计算曲线的切向量：**
    * 曲线 $C$ 在点 $P_0$ 处的切线同时位于两个曲面在 $P_0$ 处的切平面内。
    * 因此，曲线的切向量 $\mathbf{T}$ 必须同时垂直于两个曲面的法向量 $\mathbf{n}_1$ 和 $\mathbf{n}_2$。
    * 可以通过计算两个法向量的叉积（向量积）来得到切向量 $\mathbf{T}$：
        $$
        \mathbf{T} = \mathbf{n}_1 \times \mathbf{n}_2 = \nabla F(P_0) \times \nabla G(P_0)
        $$
        计算叉积：
        $$
        \mathbf{T} = \begin{vmatrix} \mathbf{i} & \mathbf{j} & \mathbf{k} \\ F_x & F_y & F_z \\ G_x & G_y & G_z \end{vmatrix}_{P_0} = (A, B, C)
        $$
        其中 $A = (F_y G_z - F_z G_y)_{P_0}$, $B = (F_z G_x - F_x G_z)_{P_0}$, $C = (F_x G_y - F_y G_x)_{P_0}$。
    * 向量 $\mathbf{T} = (A, B, C)$ 就是曲线在点 $P_0$ 处的一个切向量（方向向量）。
    * **注意：** 如果 $\mathbf{T} = (0, 0, 0)$，则说明点 $P_0$ 是奇点，或者两曲面在该点相切，需要用其他方法（如参数方程求导）处理。通常情况下 $\mathbf{T}$ 不会是零向量。

3.  **编写切线方程：**
    * 切线通过点 $P_0(x_0, y_0, z_0)$，方向向量为 $\mathbf{T} = (A, B, C)$。
    * 切线的**对称式方程**（点向式）为：
        $$
        \frac{x - x_0}{A} = \frac{y - y_0}{B} = \frac{z - z_0}{C}
        $$
        （需要注意 $A, B, C$ 中若有零，则对应分子也为零。例如，若 $A=0$，则方程为 $x-x_0=0$ 且 $\frac{y - y_0}{B} = \frac{z - z_0}{C}$）。
    * 切线的**参数方程**为：
        $$
        \begin{cases}
        x = x_0 + At \\
        y = y_0 + Bt \\
        z = z_0 + Ct
        \end{cases}
        \quad (t \in \mathbb{R})
        $$

4.  **编写法平面方程：**
    * 法平面是通过点 $P_0(x_0, y_0, z_0)$ 并且与切向量 $\mathbf{T} = (A, B, C)$ 垂直的平面。
    * 因此，法平面的法向量就是曲线的切向量 $\mathbf{T} = (A, B, C)$。
    * 法平面的方程（点法式）为：
        $$
        A(x - x_0) + B(y - y_0) + C(z - z_0) = 0
        $$
    * 展开后可得法平面的一般方程：$Ax + By + Cz - (Ax_0 + By_0 + Cz_0) = 0$。

这个步骤适用于由两个隐式方程定义的空间曲线。

---

## 求曲面方程上平行于一平面的切平面方程

已知一个由方程 $F(x, y, z) = 0$ 定义的曲面 $S$，以及一个由方程 $Ax + By + Cz + D = 0$ 定义的平面 $P$。求曲面 $S$ 上一点或多点处的切平面，使得该切平面平行于平面 $P$。

---

1.  **表示曲面和平面：**
    * 确保曲面方程表示为隐式形式 $F(x, y, z) = 0$。如果曲面以显式形式 $z = f(x, y)$ 给出，则可以将其重写为 $F(x, y, z) = z - f(x, y) = 0$ 或 $F(x, y, z) = f(x, y) - z = 0$。
    * 识别给定平面 $P: Ax + By + Cz + D = 0$ 的法向量。该法向量为 $\mathbf{n}_P = (A, B, C)$。

2.  **计算曲面函数梯度：**
    * 计算函数 $F(x, y, z)$ 的梯度：
        $$
        \nabla F(x, y, z) = \left( \frac{\partial F}{\partial x}, \frac{\partial F}{\partial y}, \frac{\partial F}{\partial z} \right)
        $$
    * 梯度 $\nabla F$ 在曲面 $S$ 上任意一点 $(x_0, y_0, z_0)$ 的值 $\nabla F(x_0, y_0, z_0)$ 是该点处曲面 $S$ 的一个法向量，也就是该点切平面的法向量 $\mathbf{n}_T$。

3.  **应用平行条件：**
    * 要求的切平面平行于给定平面 $P$，这意味着它们的法向量必须平行。
    * 因此，切平面的法向量 $\mathbf{n}_T = \nabla F(x_0, y_0, z_0)$ 必须是平面 $P$ 的法向量 $\mathbf{n}_P = (A, B, C)$ 的一个非零标量倍数。设此标量为 $\lambda$ ($\lambda \neq 0$)：
        $$
        \nabla F(x_0, y_0, z_0) = \lambda \mathbf{n}_P
        $$
    * 写出分量形式的方程组：
        $$
        \frac{\partial F}{\partial x} \bigg|_{(x_0, y_0, z_0)} = \lambda A \\
        \frac{\partial F}{\partial y} \bigg|_{(x_0, y_0, z_0)} = \lambda B \\
        \frac{\partial F}{\partial z} \bigg|_{(x_0, y_0, z_0)} = \lambda C
        $$

4.  **利用点在曲面上：**
    * 切点 $(x_0, y_0, z_0)$ 必须位于曲面 $S$ 上，因此它必须满足曲面方程：
        $$
        F(x_0, y_0, z_0) = 0
        $$

5.  **求解方程组：**
    * 联立步骤 3 中的三个方程和步骤 4 中的一个方程，构成一个关于 $x_0, y_0, z_0, \lambda$ 的方程组。
    * 求解这个方程组以确定切点 $(x_0, y_0, z_0)$ 的坐标。通常，可以从步骤 3 的方程中用 $\lambda$ 和 $A, B, C$ 表示 $x_0, y_0, z_0$（或其部分），然后代入步骤 4 的曲面方程 $F(x_0, y_0, z_0) = 0$ 来解出 $\lambda$，最后回代求得 $(x_0, y_0, z_0)$。
    * 根据方程组的性质，可能存在零个、一个或多个解，对应零个、一个或多个切点。

6.  **写出切平面方程：**
    * 对于每一个找到的切点 $(x_0, y_0, z_0)$：
    * 切平面的法向量平行于 $\mathbf{n}_P = (A, B, C)$，因此我们可以直接使用 $(A, B, C)$ 作为切平面的法向量。
    * 使用点法式方程写出切平面方程：
        $$
        A(x - x_0) + B(y - y_0) + C(z - z_0) = 0
        $$
    * 也可以将方程整理为 $Ax + By + Cz + D' = 0$ 的形式，其中 $D' = -(Ax_0 + By_0 + Cz_0)$。

最终得到的就是曲面 $S$ 上平行于平面 $P$ 的一个或多个切平面的方程。

---

## 求包含某条直线的曲面切平面方程

已知一个由方程 $F(x, y, z) = 0$ 定义的曲面 $S$，以及一条由两个相交平面 $P_1: A_1x + B_1y + C_1z + D_1 = 0$ 和 $P_2: A_2x + B_2y + C_2z + D_2 = 0$ 定义的直线 $L$。求曲面 $S$ 上一点或多点处的切平面方程，使得该切平面包含直线 $L$。

---

1.  **表示曲面和直线：**
    * 确认曲面方程为 $F(x, y, z) = 0$。
    * 确认直线 $L$ 由两个平面方程 $P_1=0$ 和 $P_2=0$ 给出。

2.  **确定曲面在任意切点的切平面方程：**
    * 设切点为 $P_0(x_0, y_0, z_0)$。此点在曲面 $S$ 上，因此满足 $F(x_0, y_0, z_0) = 0$。
    * 计算曲面函数 $F$ 的梯度：
        $$
        \nabla F(x, y, z) = \left( \frac{\partial F}{\partial x}, \frac{\partial F}{\partial y}, \frac{\partial F}{\partial z} \right)
        $$
    * 写出在点 $P_0$ 处的切平面 $\Pi_T$ 的方程（点法式）：
        $$
        \frac{\partial F}{\partial x}\bigg|_{P_0} (x - x_0) + \frac{\partial F}{\partial y}\bigg|_{P_0} (y - y_0) + \frac{\partial F}{\partial z}\bigg|_{P_0} (z - z_0) = 0
        $$
    * 将此方程展开并整理成一般形式 $N_x x + N_y y + N_z z + N_c = 0$。系数 $N_x, N_y, N_z, N_c$ 通常是 $x_0, y_0, z_0$ 的函数。
    * *注：* 对于二次曲面，利用 $F(x_0, y_0, z_0) = 0$ 通常可以简化 $N_c$ 的表达式。例如，若 $F=ax^2+by^2+cz^2-d$，则切平面为 $ax_0x+by_0y+cz_0z-d=0$ (需要具体推导验证)。

3.  **利用包含直线的平面束：**
    * 包含直线 $L$ (由 $P_1=0$ 和 $P_2=0$ 定义) 的所有平面构成一个平面束。该平面束的方程可以表示为：
        $$
        P_1 + \lambda P_2 = 0
        $$
        或者
        $$
        (A_1x + B_1y + C_1z + D_1) + \lambda(A_2x + B_2y + C_2z + D_2) = 0
        $$
        其中 $\lambda$ 是一个待定参数。
    * 将上式按 $x, y, z$ 整理，得到平面束中任意平面 $\Pi_L(\lambda)$ 的一般方程：
        $$
        (A_1 + \lambda A_2)x + (B_1 + \lambda B_2)y + (C_1 + \lambda C_2)z + (D_1 + \lambda D_2) = 0
        $$

4.  **等同切平面与平面束中的平面：**
    * 因为所求的切平面 $\Pi_T$ 必须包含直线 $L$，所以 $\Pi_T$ 必定是平面束 $\Pi_L(\lambda)$ 中的某个平面。
    * 这意味着，对于某个特定的 $\lambda$ 值，$\Pi_T$ (由 $x_0, y_0, z_0$ 决定) 和 $\Pi_L(\lambda)$ (由 $\lambda$ 决定) 代表同一个平面。
    * 因此，它们的方程系数必须成比例：
        $$
        \frac{N_x}{A_1 + \lambda A_2} = \frac{N_y}{B_1 + \lambda B_2} = \frac{N_z}{C_1 + \lambda C_2} = \frac{N_c}{D_1 + \lambda D_2} (= k)
        $$
        其中 $k$ 是某个非零比例常数。

5.  **建立并求解方程组：**
    * 将步骤 4 得到的比例关系与步骤 2 中的切点条件 $F(x_0, y_0, z_0) = 0$ 联立。
    * 这构成了一个包含 $x_0, y_0, z_0, \lambda$ (以及可能 $k$) 的方程组。
    * **策略：** 通常尝试从比例关系中用 $\lambda$ (和 $k$) 来表达 $x_0, y_0, z_0$。
        * *简化技巧：* 如果 $N_c$ 和 $D_1 + \lambda D_2$ 都非零，可以通过调整比例常数 $k$ (或等价地，调整 $\Pi_T$ 或 $\Pi_L(\lambda)$ 的方程)，使得两个方程的常数项相等。例如，如果将 $\Pi_T$ 写为 $\frac{N_x}{N_c}x + \frac{N_y}{N_c}y + \frac{N_z}{N_c}z + 1 = 0$ (假设 $N_c \neq 0$)，将 $\Pi_L(\lambda)$ 写为 $\frac{A_1 + \lambda A_2}{D_1 + \lambda D_2}x + \dots + 1 = 0$ (假设 $D_1 + \lambda D_2 \neq 0$)，然后可以直接比较 $x, y, z$ 的系数。
        * $\frac{N_x}{N_c} = \frac{A_1 + \lambda A_2}{D_1 + \lambda D_2}$
        * $\frac{N_y}{N_c} = \frac{B_1 + \lambda B_2}{D_1 + \lambda D_2}$
        * $\frac{N_z}{N_c} = \frac{C_1 + \lambda C_2}{D_1 + \lambda D_2}$
    * 将用 $\lambda$ 表示的 $x_0, y_0, z_0$ 代入曲面方程 $F(x_0, y_0, z_0) = 0$。
    * 解这个关于 $\lambda$ 的方程。可能会得到一个或多个 $\lambda$ 的解。

6.  **写出最终的切平面方程：**
    * 对于每一个求解得到的有效 $\lambda$ 值：
    * 将该 $\lambda$ 值代回到步骤 3 中的平面束方程：
        $$
        (A_1 + \lambda A_2)x + (B_1 + \lambda B_2)y + (C_1 + \lambda C_2)z + (D_1 + \lambda D_2) = 0
        $$
    * 得到的平面方程即为所求的包含直线 $L$ 的切平面方程。

最终结果可能是一个或多个平面方程。

---

## 求方向导数

---

### 求函数 f(x, y) 在某点 $P$ 处沿曲线C在该点的法线方向的方向导数

已知一个二元函数 $z = f(x, y)$，一个点 $P_0(x_0, y_0)$，以及一条通过 $P_0$ 点的曲线 $C$。曲线 $C$ 通常由某个方程 $g(x, y) = k$ (其中 $k = g(x_0, y_0)$) 隐式定义。求函数 $f(x, y)$ 在点 $P_0$ 处，沿着曲线 $C$ 在该点的 **内法线** 或 **外法线** 方向的 **方向导数**。

---

1.  **确认信息和函数梯度：**
    * 明确要求解方向导数的函数 $f(x, y)$。
    * 明确给定的点 $P_0(x_0, y_0)$。
    * 明确定义曲线 $C$ 的函数 $g(x, y)$ 及其对应的等位值 $k$（即 $g(x_0, y_0) = k$）。
    * 计算函数 $f(x, y)$ 的梯度：
        $$
        \nabla f(x, y) = \left( \frac{\partial f}{\partial x}, \frac{\partial f}{\partial y} \right)
        $$
    * 计算在点 $P_0$ 处的梯度值：$\nabla f(P_0)$。

2.  **计算曲线的法向量：**
    * 计算定义曲线的函数 $g(x, y)$ 的梯度：
        $$
        \nabla g(x, y) = \left( \frac{\partial g}{\partial x}, \frac{\partial g}{\partial y} \right)
        $$
    * 计算在点 $P_0$ 处的梯度值：$\nabla g(P_0)$。
    * $\nabla g(P_0)$ 是曲线 $C: g(x, y) = k$ 在点 $P_0$ 的一个法向量。这个向量指向 $g$ 函数值增大的方向。

3.  **确定内/外法线方向向量：**
    * 分析 $\nabla g(P_0)$ 指向的是曲线的“内部”还是“外部”。这取决于函数 $g$ 的特性以及曲线 $C$ 如何分割平面。
        * **常见情况（如圆、椭圆 $x^2/a^2 + y^2/b^2 = 1$）：** 函数 $g(x, y) = x^2/a^2 + y^2/b^2$ 在曲线外部值大于 $k=1$，在内部值小于 $k=1$。因此 $\nabla g(P_0)$ 指向 **外部**。
            * **外法线方向** 向量 $\mathbf{v}_{out} = \nabla g(P_0)$。
            * **内法线方向** 向量 $\mathbf{v}_{in} = -\nabla g(P_0)$。
        * **其他情况：** 需要具体分析 $g(x, y)$ 在曲线 $C$ 附近的值如何变化来判断 $\nabla g(P_0)$ 的指向（朝向曲线内部区域还是外部区域）。
    * 根据题目要求（求内法线还是外法线方向的导数），选择对应的方向向量 $\mathbf{v}$。例如，若求内法线方向导数且 $\nabla g(P_0)$ 指向外部，则取 $\mathbf{v} = -\nabla g(P_0)$。

4.  **单位化方向向量：**
    * 计算所选方向向量 $\mathbf{v}$ 的模（长度）：$||\mathbf{v}|| = \sqrt{v_x^2 + v_y^2}$。 （假设 $\mathbf{v} \neq \mathbf{0}$）。
    * 将 $\mathbf{v}$ 单位化，得到单位方向向量 $\mathbf{u}$：
        $$
        \mathbf{u} = \frac{\mathbf{v}}{||\mathbf{v}||} = \left( \frac{v_x}{||\mathbf{v}||}, \frac{v_y}{||\mathbf{v}||} \right)
        $$

5.  **计算方向导数：**
    * 利用方向导数的定义公式，计算 $f$ 在 $P_0$ 沿 $\mathbf{u}$ 方向的方向导数：
        $$
        D_{\mathbf{u}}f(P_0) = \nabla f(P_0) \cdot \mathbf{u}
        $$
    * 将步骤 1 中计算的 $\nabla f(P_0)$ 和步骤 4 中计算的 $\mathbf{u}$ 代入，求点积即可。

最终结果 $D_{\mathbf{u}}f(P_0)$ 就是所求的方向导数。

---

### 求函数 f(x, y, z) 在某点 P 处沿从点 A 到点 B 方向的方向导数

已知一个三元函数 $u = f(x, y, z)$，一个点 $P(x_P, y_P, z_P)$ （函数在此点求导），以及两个点 $A(x_A, y_A, z_A)$ 和 $B(x_B, y_B, z_B)$ （这两点定义了方向）。求函数 $f$ 在点 $P$ 处，沿着从点 $A$ 指向点 $B$ 的方向的 **方向导数**。

*注意：* 在很多问题中，求导点 $P$ 和定义方向的起始点 $A$ 是同一个点，即 $P=A$。

---

1.  **明确函数和点：**
    * 确认要求导数的函数 $f(x, y, z)$。
    * 确认求导数运算所在的点 $P(x_P, y_P, z_P)$。
    * 确认定义方向的起始点 $A(x_A, y_A, z_A)$ 和终点 $B(x_B, y_B, z_B)$。

2.  **计算函数梯度：**
    * 计算函数 $f(x, y, z)$ 的梯度。梯度是一个向量，由函数对各个自变量的偏导数构成：
        $$
        \nabla f(x, y, z) = \left( \frac{\partial f}{\partial x}, \frac{\partial f}{\partial y}, \frac{\partial f}{\partial z} \right)
        $$
    * 将点 $P$ 的坐标 $(x_P, y_P, z_P)$ 代入梯度表达式，得到函数在点 $P$ 处的梯度向量：
        $$
        \nabla f(P) = \nabla f(x_P, y_P, z_P)
        $$

3.  **确定方向向量：**
    * 计算从点 $A$ 指向点 $B$ 的方向向量 $\mathbf{v}$。该向量等于终点坐标减去起点坐标：
        $$
        \mathbf{v} = \vec{AB} = (x_B - x_A, y_B - y_A, z_B - z_A)
        $$

4.  **单位化方向向量：**
    * 计算方向向量 $\mathbf{v}$ 的模（即其长度或范数）：
        $$
        ||\mathbf{v}|| = \sqrt{(x_B - x_A)^2 + (y_B - y_A)^2 + (z_B - z_A)^2}
        $$
    * **重要：** 确保 $||\mathbf{v}|| \neq 0$，即点 $A$ 和点 $B$ 不重合。如果 $A=B$，则方向未定义。
    * 将方向向量 $\mathbf{v}$ 除以它的模，得到单位方向向量 $\mathbf{u}$：
        $$
        \mathbf{u} = \frac{\mathbf{v}}{||\mathbf{v}||} = \left( \frac{x_B - x_A}{||\mathbf{v}||}, \frac{y_B - y_A}{||\mathbf{v}||}, \frac{z_B - z_A}{||\mathbf{v}||} \right)
        $$
        单位向量 $\mathbf{u}$ 的模为 1，它只表示方向，不含长度信息。

5.  **计算方向导数：**
    * 函数 $f$ 在点 $P$ 处沿方向 $\mathbf{u}$ 的方向导数 $D_{\mathbf{u}}f(P)$ 等于函数在点 $P$ 的梯度 $\nabla f(P)$ 与单位方向向量 $\mathbf{u}$ 的点积（内积）：
        $$
        D_{\mathbf{u}}f(P) = \nabla f(P) \cdot \mathbf{u}
        $$
    * 将步骤 2 得到的 $\nabla f(P)$ 和步骤 4 得到的 $\mathbf{u}$ 代入，计算点积：
        $$
        D_{\mathbf{u}}f(P) = \left( \frac{\partial f}{\partial x}\bigg|_P \right) u_x + \left( \frac{\partial f}{\partial y}\bigg|_P \right) u_y + \left( \frac{\partial f}{\partial z}\bigg|_P \right) u_z
        $$
        其中 $(u_x, u_y, u_z)$ 是单位向量 $\mathbf{u}$ 的分量。

最终计算得到的标量值 $D_{\mathbf{u}}f(P)$ 就是所求的方向导数。

---

### 求函数 f(x, y, z) 在曲面上某点 $P$ 处沿曲面法线方向的方向导数

已知一个三元函数 $u = f(x, y, z)$，一个点 $P(x_P, y_P, z_P)$，以及一个包含点 $P$ 的曲面 $S$。曲面 $S$ 通常由方程 $g(x, y, z) = k$ (其中 $k = g(x_P, y_P, z_P)$) 隐式定义。求函数 $f(x, y, z)$ 在点 $P$ 处，沿着曲面 $S$ 在该点的 **内法线** 或 **外法线** 方向的 **方向导数**。

---

1.  **明确函数、点与曲面：**
    * 确认要求导数的函数 $f(x, y, z)$。
    * 确认求导数运算所在的点 $P(x_P, y_P, z_P)$。
    * 确认定义曲面 $S$ 的函数 $g(x, y, z)$ 及其对应的等位值 $k$。需验证 $g(x_P, y_P, z_P) = k$ 确保点 $P$ 在曲面上。

2.  **计算函数 $f$ 的梯度：**
    * 计算 $f(x, y, z)$ 的梯度向量：
        $$
        \nabla f(x, y, z) = \left( \frac{\partial f}{\partial x}, \frac{\partial f}{\partial y}, \frac{\partial f}{\partial z} \right)
        $$
    * 将点 $P$ 的坐标代入，得到函数在点 $P$ 处的梯度值：
        $$
        \nabla f(P) = \nabla f(x_P, y_P, z_P)
        $$

3.  **计算曲面的法向量：**
    * 计算定义曲面的函数 $g(x, y, z)$ 的梯度：
        $$
        \nabla g(x, y, z) = \left( \frac{\partial g}{\partial x}, \frac{\partial g}{\partial y}, \frac{\partial g}{\partial z} \right)
        $$
    * 将点 $P$ 的坐标代入，得到曲面在点 $P$ 处的一个法向量：
        $$
        \nabla g(P) = \nabla g(x_P, y_P, z_P)
        $$
    * 向量 $\nabla g(P)$ 垂直于曲面 $S$ 在点 $P$ 的切平面，并指向 $g$ 函数值增大的方向。

4.  **确定内/外法线方向向量：**
    * 判断 $\nabla g(P)$ 的指向是曲面的“内部”还是“外部”。这需要理解函数 $g$ 和曲面 $S$ 的几何关系。
        * **常见情况（如球面、椭球面 $g=k$）：** 若函数 $g(x, y, z)$ 在曲面外部的值大于 $k$，在内部的值小于 $k$（例如 $g = x^2+y^2+z^2$ 定义球面 $g=k$），则 $\nabla g(P)$ 指向 **外部**。
            * **外法线方向** 向量可选为 $\mathbf{v}_{out} = \nabla g(P)$。
            * **内法线方向** 向量可选为 $\mathbf{v}_{in} = -\nabla g(P)$。
        * **其他情况：** 若 $g$ 在曲面外部值小于 $k$，内部值大于 $k$，则 $\nabla g(P)$ 指向 **内部**。
            * **外法线方向** 向量可选为 $\mathbf{v}_{out} = -\nabla g(P)$。
            * **内法线方向** 向量可选为 $\mathbf{v}_{in} = \nabla g(P)$。
    * 根据题目要求（内法线或外法线），确定所需要的方向向量 $\mathbf{v}$。

5.  **单位化方向向量：**
    * 计算所选方向向量 $\mathbf{v}$ 的模（长度）：$||\mathbf{v}|| = \sqrt{v_x^2 + v_y^2 + v_z^2}$。 （假设 $\mathbf{v} \neq \mathbf{0}$）。
    * 将 $\mathbf{v}$ 单位化，得到单位方向向量 $\mathbf{u}$：
        $$
        \mathbf{u} = \frac{\mathbf{v}}{||\mathbf{v}||} = \left( \frac{v_x}{||\mathbf{v}||}, \frac{v_y}{||\mathbf{v}||}, \frac{v_z}{||\mathbf{v}||} \right)
        $$

6.  **计算方向导数：**
    * 函数 $f$ 在点 $P$ 处沿方向 $\mathbf{u}$ 的方向导数 $D_{\mathbf{u}}f(P)$ 等于函数在点 $P$ 的梯度 $\nabla f(P)$ 与单位方向向量 $\mathbf{u}$ 的点积（内积）：
        $$
        D_{\mathbf{u}}f(P) = \nabla f(P) \cdot \mathbf{u}
        $$
    * 代入 $\nabla f(P)$ 和 $\mathbf{u}$ 的分量进行计算：
        $$
        D_{\mathbf{u}}f(P) = \left( \frac{\partial f}{\partial x}\bigg|_P \right) u_x + \left( \frac{\partial f}{\partial y}\bigg|_P \right) u_y + \left( \frac{\partial f}{\partial z}\bigg|_P \right) u_z
        $$

最终结果 $D_{\mathbf{u}}f(P)$ 是一个标量值，即所求的方向导数。

---

### 求函数 f(x, y, z) 在某点变化最快的方向及该方向导数

已知一个三元（或二元）函数 $u = f(x, y, z)$ （或 $z=f(x,y)$）以及一个点 $P(x_P, y_P, z_P)$ （或 $P(x_P, y_P)$）。求：
1.  函数 $f$ 在点 $P$ 处 **变化最快**（即增加最快）的 **方向**。
2.  函数 $f$ 在点 $P$ 处沿这个方向的 **方向导数**（即最大变化率）。

---
**原理：**
* 一个可微函数在某一点处，其值 **增加最快** 的方向是该点 **梯度向量 $\nabla f(P)$ 的方向**。
* 函数在该点处的 **最大变化率**（即沿梯度方向的方向导数）等于该点 **梯度向量的模 $||\nabla f(P)||$**。
* 相应地，函数值 **减少最快** 的方向是 **负梯度向量 $-\nabla f(P)$ 的方向**，其变化率（减少）为 **$-||\nabla f(P)||$**。

**通用解法步骤 (以三元函数为例)：**

1.  **明确函数和点：**
    * 确认要求解的函数 $f(x, y, z)$。
    * 确认给定的点 $P(x_P, y_P, z_P)$。

2.  **计算函数的梯度：**
    * 计算函数 $f$ 对各个变量的偏导数：$\frac{\partial f}{\partial x}$, $\frac{\partial f}{\partial y}$, $\frac{\partial f}{\partial z}$。
    * 构成梯度向量：
        $$
        \nabla f(x, y, z) = \left( \frac{\partial f}{\partial x}, \frac{\partial f}{\partial y}, \frac{\partial f}{\partial z} \right)
        $$

3.  **计算在指定点的梯度：**
    * 将点 $P$ 的坐标 $(x_P, y_P, z_P)$ 代入梯度向量表达式，得到函数在点 $P$ 处的具体梯度向量：
        $$
        \nabla f(P) = \nabla f(x_P, y_P, z_P) = \left( \frac{\partial f}{\partial x}\bigg|_P, \frac{\partial f}{\partial y}\bigg|_P, \frac{\partial f}{\partial z}\bigg|_P \right)
        $$
    * **特殊情况：** 如果 $\nabla f(P) = (0, 0, 0) = \mathbf{0}$，则函数在点 $P$ 处所有方向的方向导数都为 0，没有唯一的最快变化方向。

4.  **确定变化最快的方向：**
    * 如果 $\nabla f(P) \neq \mathbf{0}$，函数 $f$ 在点 $P$ 处变化最快的方向就是向量 $\nabla f(P)$ 所指的方向。
    * 这个方向可以由向量 $\nabla f(P)$ 本身表示。
    * 如果要求用 **单位向量** 来表示这个方向，则需要计算梯度向量的模：
        $$
        ||\nabla f(P)|| = \sqrt{\left(\frac{\partial f}{\partial x}\bigg|_P\right)^2 + \left(\frac{\partial f}{\partial y}\bigg|_P\right)^2 + \left(\frac{\partial f}{\partial z}\bigg|_P\right)^2}
        $$
    * 最快变化方向的单位向量 $\mathbf{u}_{max}$ 为：
        $$
        \mathbf{u}_{max} = \frac{\nabla f(P)}{||\nabla f(P)||}
        $$

5.  **计算沿最快变化方向的方向导数（最大变化率）：**
    * 函数 $f$ 在点 $P$ 处沿最快变化方向（即梯度方向 $\mathbf{u}_{max}$）的方向导数，就是函数在该点的最大变化率。
    * 这个值等于梯度向量 $\nabla f(P)$ 的模：
        $$
        \text{最大方向导数} = D_{\mathbf{u}_{max}}f(P) = ||\nabla f(P)||
        $$
    * 该值已在步骤 4 中计算梯度模时得到。

**总结：**

* **最快变化方向**：由 $\nabla f(P)$ 给出（或其单位向量 $\frac{\nabla f(P)}{||\nabla f(P)||}$）。
* **最大变化率（该方向的方向导数）**：$||\nabla f(P)||$。

对于二元函数 $f(x, y)$，步骤完全类似，只是梯度向量为 $\nabla f = (\frac{\partial f}{\partial x}, \frac{\partial f}{\partial y})$。

---

## 求二元函数极值点与极值

**目标：** 找到函数 $f(x, y)$ 的局部极大值点、局部极小值点以及对应的极值。

---

**步骤：**

1.  **计算一阶偏导数：**
    求函数 $f(x, y)$ 对 $x$ 和 $y$ 的一阶偏导数：
    $f_x(x, y) = \frac{\partial f}{\partial x}$
    $f_y(x, y) = \frac{\partial f}{\partial y}$

2.  **寻找驻点（Critical Points）：**
    求解方程组，找到所有满足条件的点 $(x_0, y_0)$：
    $$
    \begin{cases}
    f_x(x, y) = 0 \\
    f_y(x, y) = 0
    \end{cases}
    $$
    这些点 $(x_0, y_0)$ 称为驻点（或临界点）。注意：如果偏导数在某些点不存在，这些点也应视为临界点，但在常见问题中较少出现。

3.  **计算二阶偏导数：**
    求函数 $f(x, y)$ 的所有二阶偏导数：
    $$f_{xx}(x, y) = \frac{\partial^2 f}{\partial x^2},  
    
    f_{yy}(x, y) = \frac{\partial^2 f}{\partial y^2},  
    
    f_{xy}(x, y) = \frac{\partial^2 f}{\partial x \partial y}$$
    (对于大多数表现良好的函数，有 $f_{xy} = f_{yx}$)

4.  **应用二阶导数判别法：**
    对于每一个驻点 $(x_0, y_0)$：
    a.  计算判别式（Hessian 矩阵的行列式） $D$ 在该点的值：
        $$
        D(x_0, y_0) = f_{xx}(x_0, y_0) f_{yy}(x_0, y_0) - [f_{xy}(x_0, y_0)]^2
        $$
        
    b.  根据 $D$ 和 $f_{xx}(x_0, y_0)$ 的值判断驻点的类型：
        * 如果 $D > 0$ 且 $f_{xx}(x_0, y_0) > 0$，则函数 $f$ 在 $(x_0, y_0)$ 处取得**局部极小值**。
        * 如果 $D > 0$ 且 $f_{xx}(x_0, y_0) < 0$，则函数 $f$ 在 $(x_0, y_0)$ 处取得**局部极大值**。
        * 如果 $D < 0$，则 $(x_0, y_0)$ 是一个**鞍点**（既非局部极大值也非局部极小值）。
        * 如果 $D = 0$，则此判别法**失效**，需要用其他方法（例如，观察点附近函数值的符号）来判断。

5.  **计算极值：**
    如果在 $(x_0, y_0)$ 处存在局部极大值或极小值，则对应的极值为函数在该点的值 $f(x_0, y_0)$。

---

## 求空间直线最短距离

**1. 准备工作：直线的参数方程**

* 将两条直线 $L_1$ 和 $L_2$ 都表示为参数方程形式：
    * $L_1: \mathbf{r}_1(t) = \mathbf{p}_1 + t \mathbf{v}_1$
    * $L_2: \mathbf{r}_2(s) = \mathbf{p}_2 + s \mathbf{v}_2$
    其中，$\mathbf{p}_1 = (x_1, y_1, z_1)$ 是 $L_1$ 上的一点，$\mathbf{v}_1 = \langle a_1, b_1, c_1 \rangle$ 是 $L_1$ 的方向向量。
    $\mathbf{p}_2 = (x_2, y_2, z_2)$ 是 $L_2$ 上的一点，$\mathbf{v}_2 = \langle a_2, b_2, c_2 \rangle$ 是 $L_2$ 的方向向量。
    $t$ 和 $s$ 是参数。

**2. 判断直线关系：平行、相交还是异面**

* **检查是否平行：**
    比较方向向量 $\mathbf{v}_1$ 和 $\mathbf{v}_2$。如果存在标量 $k$ 使得 $\mathbf{v}_1 = k \mathbf{v}_2$，则两直线平行。
    * 若平行，转到 **步骤 3**。
    * 若不平行，转到 **步骤 4**。

* **步骤 3：处理平行直线**
    如果 $\mathbf{v}_1$ 和 $\mathbf{v}_2$ 平行，计算点 $\mathbf{p}_1$ 到直线 $L_2$ 的距离（或点 $\mathbf{p}_2$ 到 $L_1$ 的距离）。取向量 $\vec{P_1 P_2} = \mathbf{p}_2 - \mathbf{p}_1$。最短距离 $d$ 为：
    $$
    d = \frac{||\vec{P_1 P_2} \times \mathbf{v}_2||}{||\mathbf{v}_2||}
    $$
    (使用 $\mathbf{v}_1$ 也可以得到相同结果)。计算完毕，结束。

* **步骤 4：检查是否相交 (非平行情况)**
    尝试解方程组 $\mathbf{r}_1(t) = \mathbf{r}_2(s)$，即：
    $$
    \mathbf{p}_1 + t \mathbf{v}_1 = \mathbf{p}_2 + s \mathbf{v}_2
    $$
    这会得到一个关于 $t$ 和 $s$ 的三元线性方程组。
    * 如果方程组有唯一解 $(t_0, s_0)$，则两直线相交于一点。最短距离 $d = 0$。计算完毕，结束。
    * 如果方程组无解，则两直线既不平行也不相交，它们是**异面直线**。转到 **步骤 5**。

**5. 计算异面直线的最短距离**

* 两直线异面。计算向量 $\vec{P_1 P_2} = \mathbf{p}_2 - \mathbf{p}_1$。
* 计算方向向量的叉积：$\mathbf{n} = \mathbf{v}_1 \times \mathbf{v}_2$。这个向量 $\mathbf{n}$ 同时垂直于 $\mathbf{v}_1$ 和 $\mathbf{v}_2$。
* 最短距离 $d$ 是向量 $\vec{P_1 P_2}$ 在法向量 $\mathbf{n}$ 方向上的投影的绝对值：
    $$
    d = \frac{|\vec{P_1 P_2} \cdot (\mathbf{v}_1 \times \mathbf{v}_2)|}{||\mathbf{v}_1 \times \mathbf{v}_2||}
    $$

---

## 求到三直线距离平方和最小的点

**目标：** 给定平面上的三条直线 $L_1, L_2, L_3$，找到一个点 $P(x, y)$，使得 $P$ 到这三条直线的距离的平方和最小。

---

**步骤：**

1.  **表示直线方程：**
    将三条直线方程写成一般形式：
    * $L_1: A_1x + B_1y + C_1 = 0$
    * $L_2: A_2x + B_2y + C_2 = 0$
    * $L_3: A_3x + B_3y + C_3 = 0$

2.  **计算距离平方：**
    点 $P(x, y)$ 到直线 $L_i: A_ix + B_iy + C_i = 0$ 的距离平方 $d_i^2$ 为：
    $$
    d_i^2 = \frac{(A_ix + B_iy + C_i)^2}{A_i^2 + B_i^2}
    $$
    为了简化表示，令 $k_i = A_i^2 + B_i^2$，则 $d_i^2 = \frac{(A_ix + B_iy + C_i)^2}{k_i}$。

3.  **建立目标函数：**
    需要最小化的函数是距离平方和 $S(x, y)$:
    $$
    S(x, y) = d_1^2 + d_2^2 + d_3^2 = \frac{(A_1x + B_1y + C_1)^2}{k_1} + \frac{(A_2x + B_2y + C_2)^2}{k_2} + \frac{(A_3x + B_3y + C_3)^2}{k_3}
    $$

4.  **计算偏导数：**
    计算 $S(x, y)$ 对 $x$ 和 $y$ 的一阶偏导数：
    * $S_x = \frac{\partial S}{\partial x} = \frac{2A_1(A_1x + B_1y + C_1)}{k_1} + \frac{2A_2(A_2x + B_2y + C_2)}{k_2} + \frac{2A_3(A_3x + B_3y + C_3)}{k_3}$
    * $S_y = \frac{\partial S}{\partial y} = \frac{2B_1(A_1x + B_1y + C_1)}{k_1} + \frac{2B_2(A_2x + B_2y + C_2)}{k_2} + \frac{2B_3(A_3x + B_3y + C_3)}{k_3}$

5.  **求解驻点（Critical Point）：**
    令一阶偏导数等于零，得到关于 $x$ 和 $y$ 的线性方程组：
    $$
    \begin{cases}
    \frac{A_1(A_1x + B_1y + C_1)}{k_1} + \frac{A_2(A_2x + B_2y + C_2)}{k_2} + \frac{A_3(A_3x + B_3y + C_3)}{k_3} = 0 \\
    \frac{B_1(A_1x + B_1y + C_1)}{k_1} + \frac{B_2(A_2x + B_2y + C_2)}{k_2} + \frac{B_3(A_3x + B_3y + C_3)}{k_3} = 0
    \end{cases}
    $$
    整理这个方程组，将其写成标准形式：
    $$
    \begin{cases}
    a_{11}x + a_{12}y = c_1 \\
    a_{21}x + a_{22}y = c_2
    \end{cases}
    $$
    其中系数 $a_{ij}$ 和常数 $c_i$ 由直线方程的系数 $A_i, B_i, C_i$ 决定。例如：
    $a_{11} = \frac{A_1^2}{k_1} + \frac{A_2^2}{k_2} + \frac{A_3^2}{k_3}$
    $a_{12} = \frac{A_1B_1}{k_1} + \frac{A_2B_2}{k_2} + \frac{A_3B_3}{k_3}$
    $c_1 = -\left(\frac{A_1C_1}{k_1} + \frac{A_2C_2}{k_2} + \frac{A_3C_3}{k_3}\right)$
    （其他系数类似计算）。
    求解这个线性方程组，得到唯一的解 $(x_0, y_0)$。（除非三条直线有特殊关系，如平行且等距，通常有唯一解）。

6.  **确定结果：**
    由于目标函数 $S(x, y)$ 是一个二次函数（具体来说是各项系数非负的二次型），其图像是一个向上开口的（椭圆）抛物面，因此找到的唯一驻点 $(x_0, y_0)$ 就是使得距离平方和最小的点。
    （严格证明可以通过二阶导数判别法，计算 $D = S_{xx}S_{yy} - (S_{xy})^2$ 和 $S_{xx}$ 的符号，通常 $D > 0$ 且 $S_{xx} > 0$）。

---

## 拉格朗日乘数法

---
### 求球体内接最大体积的长方体

**目标：** 找到一个长方体，其完全包含在半径为 $a$ 的球体内部，并且该长方体的体积达到最大。

---

**步骤：**

1.  **建立数学模型：**
    * 假设球心位于坐标原点 $(0, 0, 0)$，则球面方程为 $x^2 + y^2 + z^2 = a^2$。
    * 设内接长方体的中心也位于原点，其顶点位于 $(\pm x, \pm y, \pm z)$。这里 $x, y, z$ 分别代表长方体半长、半宽、半高，且 $x > 0, y > 0, z > 0$。
    * 长方体的实际尺寸为：长 = $2x$，宽 = $2y$，高 = $2z$。
    * **目标函数 (体积)**：需要最大化的体积为 $V(x, y, z) = (2x)(2y)(2z) = 8xyz$。
    * **约束条件**：长方体的顶点 $(x, y, z)$ 必须在球面上，因此满足 $g(x, y, z) = x^2 + y^2 + z^2 - a^2 = 0$。

2.  **应用拉格朗日乘数法：**
    * 构造拉格朗日函数 $L(x, y, z, \lambda) = V(x, y, z) - \lambda g(x, y, z)$：
        $$
        L(x, y, z, \lambda) = 8xyz - \lambda (x^2 + y^2 + z^2 - a^2)
        $$
    * 求解方程组 $\nabla L = \mathbf{0}$，即 $L$ 对 $x, y, z, \lambda$ 的偏导数等于零：
        $$
        \begin{cases}
        \frac{\partial L}{\partial x} = 8yz - 2\lambda x = 0 \quad &(1) \\
        \frac{\partial L}{\partial y} = 8xz - 2\lambda y = 0 \quad &(2) \\
        \frac{\partial L}{\partial z} = 8xy - 2\lambda z = 0 \quad &(3) \\
        \frac{\partial L}{\partial \lambda} = -(x^2 + y^2 + z^2 - a^2) = 0 \implies x^2 + y^2 + z^2 = a^2 \quad &(4)
        \end{cases}
        $$

3.  **求解方程组：**
    * 假设 $x, y, z$ 均不为零（否则体积为零，不是最大值），则 $\lambda$ 也不为零。
    * 将 (1), (2), (3) 分别乘以 $x, y, z$：
        $8xyz = 2\lambda x^2$
        $8xyz = 2\lambda y^2$
        $8xyz = 2\lambda z^2$
    * 由此可得 $2\lambda x^2 = 2\lambda y^2 = 2\lambda z^2$。因为 $2\lambda \neq 0$，所以 $x^2 = y^2 = z^2$。
    * 由于 $x, y, z$ 均为正数，因此 $x = y = z$。
    * 将 $x = y = z$ 代入约束条件 (4)：
        $x^2 + x^2 + x^2 = a^2 \implies 3x^2 = a^2$
    * 解得 $x^2 = \frac{a^2}{3}$，所以 $x = \frac{a}{\sqrt{3}} = \frac{a\sqrt{3}}{3}$。
    * 因此，取得最大体积时，$x = y = z = \frac{a\sqrt{3}}{3}$。

4.  **确定长方体尺寸和最大体积：**
    * 长方体的半边长为 $x = y = z = \frac{a\sqrt{3}}{3}$。
    * 长方体的实际尺寸为 长=宽=高= $2x = \frac{2a\sqrt{3}}{3}$。
    * 这意味着具有最大体积的内接长方体是一个**立方体**。
    * 该立方体的边长为 $\frac{2a\sqrt{3}}{3}$。
    * 最大体积 $V_{max} = 8xyz = 8 \left( \frac{a\sqrt{3}}{3} \right)^3 = \frac{8 a^3 \cdot 3\sqrt{3}}{27} = \frac{8a^3\sqrt{3}}{9}$。

---

# 第10章 重积分

---

## 求解二重积分

**对于二重积分 $\iint_D f(x,y) \, d\sigma$ 的求解：**

---

**1. 理解和确定积分区域 $D$ (核心步骤)**

这是设置积分上下限的基础，需要特别仔细。

* **识别边界：** 明确构成区域 $D$ 边界的是哪些曲线或直线。题目通常会直接给出这些边界的方程 (例如 $y=x^2$, $y=\sqrt{x}$, $x=2$, $y=2$, $x^2+y^2=4$, $y=1/x$ 等)。
* **求解交点：** 计算构成边界的各条曲线/直线之间的交点坐标。通过联立方程组求解，例如：
    * 曲线 $y=g_1(x)$ 和 $y=g_2(x)$ 的交点：解方程 $g_1(x) = g_2(x)$ 得到 $x$ 值，再代回任一方程求 $y$ 值。
    * 曲线 $x=h_1(y)$ 和 $x=h_2(y)$ 的交点：解方程 $h_1(y) = h_2(y)$ 得到 $y$ 值，再代回任一方程求 $x$ 值。
    * 曲线 $y=g(x)$ 和直线 $x=a$ 的交点：将 $x=a$ 代入 $y=g(x)$ 求 $y$。
    * 曲线 $x=h(y)$ 和直线 $y=c$ 的交点：将 $y=c$ 代入 $x=h(y)$ 求 $x$。
    这些交点有助于确定变量的取值范围。
* **绘制草图：** 在 $xy$ 平面上绘制出所有的边界曲线和直线，并标出重要的交点。根据边界围成的区域，准确地画出（或想象出）积分区域 $D$ 的形状。**这一步对于正确设定积分限至关重要。**
* **分析区域类型：** 观察区域 $D$ 的形状。
    * 它是矩形区域吗？($a \le x \le b, c \le y \le d$)
    * 它是 $x$-型区域 (Type I) 吗？即对于 $x$ 在某个区间 $[a, b]$ 内，区域的上下边界可以由 $y=g_1(x)$ 和 $y=g_2(x)$ 统一表示 ($g_1(x) \le y \le g_2(x)$)？
    * 它是 $y$-型区域 (Type II) 吗？即对于 $y$ 在某个区间 $[c, d]$ 内，区域的左右边界可以由 $x=h_1(y)$ 和 $x=h_2(y)$ 统一表示 ($h_1(y) \le x \le h_2(y)$)？
    * 区域是否需要分割？如果区域的边界函数发生变化（例如 Problem 4(3) 和 4(4)），则可能需要将 $D$ 分割成几个子区域 $D_1, D_2, \dots$，然后在每个子区域上分别积分再求和。
    * 区域是否具有圆或扇形特征？(例如 Problem 4(2) 和 4(4)) 这提示可能使用极坐标更方便。

**2. 选择合适的坐标系**

* **笛卡尔坐标 $(x, y)$：** 适用于边界是直线或可以用 $y=g(x)$ 或 $x=h(y)$ 简单表示的区域。这是最常用的坐标系。$d\sigma = dx \, dy$ 或 $dy \, dx$。
* **极坐标 $(r, \theta)$：** 适用于圆形、扇形、环形区域，或者被积函数 $f(x,y)$ 中含有 $x^2+y^2$ 或形式上在极坐标下更简单的表达式。转换关系：$x=r\cos\theta$, $y=r\sin\theta$。面积微元 $d\sigma = r \, dr \, d\theta$ (注意多乘一个 $r$)。

**3. 确定积分顺序和上下限 (以笛卡尔坐标为例)**

根据步骤 1 中对区域类型的分析，选择一个更方便的积分顺序。

* **选择顺序 $dy \, dx$ (适用于 $x$-型区域 / Type I):**
    1.  确定 $x$ 的积分范围 $[a, b]$：找到区域 $D$ 在 $x$ 轴上的投影区间。
    2.  确定 $y$ 的积分范围 $[g_1(x), g_2(x)]$：对于固定的 $x \in [a, b]$，沿 $y$ 方向穿过区域 $D$，确定 $y$ 的下界函数 $y=g_1(x)$ 和上界函数 $y=g_2(x)$。
    3.  写出累次积分：
        $$
        \iint_D f(x,y) \, d\sigma = \int_a^b \left[ \int_{g_1(x)}^{g_2(x)} f(x,y) \, dy \right] dx
        $$

* **选择顺序 $dx \, dy$ (适用于 $y$-型区域 / Type II):**
    1.  确定 $y$ 的积分范围 $[c, d]$：找到区域 $D$ 在 $y$ 轴上的投影区间。
    2.  确定 $x$ 的积分范围 $[h_1(y), h_2(y)]$：对于固定的 $y \in [c, d]$，沿 $x$ 方向穿过区域 $D$，确定 $x$ 的左界函数 $x=h_1(y)$ 和右界函数 $x=h_2(y)$。
    3.  写出累次积分：
        $$
        \iint_D f(x,y) \, d\sigma = \int_c^d \left[ \int_{h_1(y)}^{h_2(y)} f(x,y) \, dx \right] dy
        $$

* **选择原则：** 优先选择不需要分割区域、积分限形式更简单的顺序。有时被积函数的形式也会影响积分难易度，需要权衡。

**4. 计算累次积分**

* **先计算内层积分：** 将外层积分变量视为常数，对内层积分变量进行定积分。
* **再计算外层积分：** 将内层积分得到的结果（只含外层变量的函数）代入，对外层变量进行定积分。

**5. 特殊情况：矩形区域 + 可分离函数**

如果积分区域是矩形 $D = [a, b] \times [c, d]$ 且被积函数可分离变量 $f(x,y) = f_1(x) f_2(y)$，则积分可以简化为两个单变量定积分的乘积：
$$
\iint_D f_1(x) f_2(y) \, d\sigma = \left[ \int_a^b f_1(x) \, dx \right] \cdot \left[ \int_c^d f_2(y) \, dy \right]
$$

---

## 在直角坐标系和柱面坐标系下计算三重积分

计算三重积分 $\iiint_{\Omega} f(x,y,z) dV$ 的核心思想是将其转化为**累次积分**（也叫迭代积分），也就是把三重积分变成三次单变量的定积分。关键在于如何根据积分区域 $\Omega$ 和所选的坐标系来正确地确定积分的上下限以及体积微元 $dV$。

---

### 一、直角坐标系

在直角坐标系 (Cartesian Coordinates) 中，我们用 $(x, y, z)$ 来表示点的位置，体积微元是 $dV = dx dy dz$ (或者它的其他排列组合，如 $dz dy dx$ 等)。

1.  **理解与可视化积分区域 $\Omega$**：
    *   这是最重要也是最基础的一步。仔细阅读题目给出的描述积分区域 $\Omega$ 的不等式或等式。
    *   尝试画出积分区域 $\Omega$ 的草图。明确它是由哪些曲面或平面围成的。了解区域的形状对于后续确定积分限至关重要。

2.  **选择合适的积分次序**：
    *   三重积分有 $3! = 6$ 种可能的积分次序，例如 $dzdydx, dzdxdy, dydzdx, \dots$。
    *   选择的原则是使得积分限的表达式尽可能简单，并且被积函数 $f(x,y,z)$ 在该次序下更容易积分。
    *   **通常做法（投影法/“穿针法”）**：
        *   先确定一个变量的积分限，例如 $z$。这个变量的积分限通常是关于另外两个变量 $x, y$ 的函数。
        *   然后将三维区域 $\Omega$ 投影到由另外两个变量构成的坐标平面上（例如，如果先积 $z$，则投影到 $xy$ 平面得到投影区域 $D_{xy}$）。
        *   再确定这个二维投影区域 $D_{xy}$ 上二重积分的积分限。

3.  **确定各变量的积分限**：
    以积分次序 $dzdydx$ 为例（先对 $z$ 积，再对 $y$ 积，最后对 $x$ 积）：
    *   **内层积分 (对 $z$)**：想象一条平行于 $z$ 轴的直线穿过积分区域 $\Omega$。
        *   直线从下表面 $z = h_1(x,y)$ 进入区域。
        *   直线从上表面 $z = h_2(x,y)$ 穿出区域。
        *   那么 $z$ 的积分限就是从 $h_1(x,y)$ 到 $h_2(x,y)$。
        即：$\int_{h_1(x,y)}^{h_2(x,y)} f(x,y,z) dz$
    *   **中间层积分 (对 $y$)**：现在考虑区域 $\Omega$ 在 $xy$ 平面上的投影区域 $D_{xy}$。在这个二维区域 $D_{xy}$ 上，想象一条平行于 $y$ 轴的直线。
        *   直线从下边界曲线 $y = g_1(x)$ 进入 $D_{xy}$。
        *   直线从上边界曲线 $y = g_2(x)$ 穿出 $D_{xy}$。
        *   那么 $y$ 的积分限就是从 $g_1(x)$ 到 $g_2(x)$。
    *   **外层积分 (对 $x$)**：最后确定 $x$ 的变化范围。这通常是投影区域 $D_{xy}$ 在 $x$ 轴上的覆盖区间，设为从 $a$ 到 $b$。外层积分的上下限必须是**常数**。
        即：$a \le x \le b$

4.  **写出累次积分表达式**：
    根据上述确定的积分限，三重积分就化为了累次积分：
    $$ \iiint_{\Omega} f(x,y,z) dV = \int_{a}^{b} \left( \int_{g_1(x)}^{g_2(x)} \left( \int_{h_1(x,y)}^{h_2(x,y)} f(x,y,z) dz \right) dy \right) dx $$
    或者简写为：
    $$ \int_{a}^{b} dx \int_{g_1(x)}^{g_2(x)} dy \int_{h_1(x,y)}^{h_2(x,y)} f(x,y,z) dz $$

5.  **计算累次积分**：
    从最内层的积分开始，逐层向外计算定积分。
    *   先计算关于 $z$ 的定积分，此时将 $x, y$ 视为常数。得到的结果是一个关于 $x, y$ 的函数。
    *   再计算关于 $y$ 的定积分，此时将 $x$ 视为常数。得到的结果是一个关于 $x$ 的函数。
    *   最后计算关于 $x$ 的定积分，得到最终的数值结果。

---

### 二、柱面坐标系

当积分区域 $\Omega$ 或被积函数 $f(x,y,z)$ 具有某种“柱对称性”（例如，区域是圆柱体、圆锥体、旋转抛物面，或者被积函数中含有 $x^2+y^2$ 这样的项）时，使用柱面坐标系 (Cylindrical Coordinates) 往往能简化计算。

1.  **选择合适的柱面坐标变换形式并进行坐标变换**：
    *   **标准形式 (绕 $z$ 轴对称)**:
        $x = r \cos\theta$
        $y = r \sin\theta$
        $z = z$
        其中 $r \ge 0$, $\theta$ 通常取 $[0, 2\pi]$ (或根据对称性选择其他范围)。
        体积微元 $dV = dx dy dz$ 转换为 $r dr d\theta dz$ (或 $r dz dr d\theta$ 等)。这个 $r$ 是**雅可比行列式 (Jacobian)** 的绝对值，**非常重要，一定不能漏掉！**
    *   **其他形式 (例如绕 $y$ 轴对称，如我们之前题目所示)**:
        $x = r \cos\theta$
        $z = r \sin\theta$
        $y = y$
        体积微元 $dV = r dr d\theta dy$ (或 $r dy dr d\theta$ 等)。
    你需要根据积分区域的对称轴来选择合适的柱面坐标形式。

2.  **转换被积函数 $f(x,y,z)$**：
    将直角坐标下的被积函数 $f(x,y,z)$ 中的 $x, y, z$ 替换为它们在所选柱面坐标系下的表达式。
    例如，对于标准形式，替换为 $f(r\cos\theta, r\sin\theta, z)$。

3.  **转换积分区域 $\Omega$ (确定新坐标下的边界)**：
    将描述积分区域 $\Omega$ 的直角坐标不等式或等式，用柱面坐标变量 $(r, \theta, z)$ （或对应的变体）来表示，从而得到新坐标系下积分区域 $\Omega'$ 的边界。
    例如，对于标准形式：
    *   $x^2+y^2 = R^2$ (圆柱面) 变为 $r^2 = R^2 \Rightarrow r=R$。
    *   $z = x^2+y^2$ (旋转抛物面) 变为 $z=r^2$。
    *   平面 $y=x$ 变为 $r\sin\theta = r\cos\theta \Rightarrow \tan\theta = 1 \Rightarrow \theta = \pi/4, 5\pi/4$。

4.  **确定新坐标下的积分次序和积分限**：
    与直角坐标系类似，选择一个积分次序，如 $dz dr d\theta$ (标准形式下常用)。
    *   **内层积分 (对 $z$)**：$z$ 的积分限通常是 $r, \theta$ 的函数，即从 $z = h_1(r,\theta)$ 到 $z = h_2(r,\theta)$。
    *   **中间层积分 (对 $r$)**：$r$ 的积分限通常是 $\theta$ 的函数，即从 $r = g_1(\theta)$ 到 $r = g_2(\theta)$。这通常对应于原区域在 $xy$ 平面上的投影区域 $D_{xy}$ 在极坐标下的描述。
    *   **外层积分 (对 $\theta$)**：$\theta$ 的积分限通常是常数，例如从 $\alpha$ 到 $\beta$。

5.  **写出累次积分表达式 (包含雅可比行列式 $r$)**：
    $$ \iiint_{\Omega} f(x,y,z) dV = \iiint_{\Omega'} f(r\cos\theta, r\sin\theta, z) \cdot r dz dr d\theta $$
    展开为累次积分形式（以 $dz dr d\theta$ 为例）：
    $$ \int_{\alpha}^{\beta} d\theta \int_{g_1(\theta)}^{g_2(\theta)} dr \int_{h_1(r,\theta)}^{h_2(r,\theta)} f(r\cos\theta, r\sin\theta, z) \cdot r dz $$
    **再次强调：千万不要忘记乘以雅可比行列式 $r$！**

6.  **计算累次积分**：
    从内向外依次计算定积分。

---

### 三、总结与选择

*   **何时选择直角坐标？**
    *   当积分区域 $\Omega$ 是由平面围成的简单几何体（如长方体、棱柱、四面体等）时。
    *   当被积函数在直角坐标下形式简单，且积分限也容易确定时。
*   **何时选择柱面坐标？**
    *   当积分区域 $\Omega$ 具有绕某一坐标轴的旋转对称性时，如圆柱、圆锥、球面（部分）、旋转抛物面等。
    *   当积分区域在某一坐标平面上的投影是圆形或扇形区域时。
    *   当被积函数中含有 $x^2+y^2$ (或 $x^2+z^2$, $y^2+z^2$) 这样的项时，转换到柱面坐标可以简化为 $r^2$。
*   **重要提示**：
    *   即使在直角坐标系下进行三重积分，当计算投影区域上的二重积分时，如果投影区域是圆形或扇形，也经常会再次使用**极坐标变换**（这本质上是柱面坐标在二维的体现）。

---

# 第11章 曲线积分与曲面积分

---

## 由线密度和方程求曲线型构件质心

求解曲线构件质心的核心是利用**第一类曲线积分 (对弧长的曲线积分)** 来计算构件的总质量和其对坐标轴的静矩。

设曲线构件 $L$ 上任意一点 $(x,y)$ 处的线密度为 $\rho(x,y)$。构件的质心坐标为 $(\bar{x}, \bar{y})$。

1.  **写出质心坐标的计算公式**：
    质心坐标由以下公式给出：
    $$ \bar{x} = \frac{M_y}{M} $$
    $$ \bar{y} = \frac{M_x}{M} $$
    其中：
    *   $M$ 是构件的总质量。
    *   $M_y$ 是构件对 $y$ 轴的静矩。
    *   $M_x$ 是构件对 $x$ 轴的静矩。

2.  **写出总质量 $M$ 和静矩 $M_y, M_x$ 的积分表达式**：
    这些量都是通过第一类曲线积分来计算的：
    *   总质量 $M$:
        $$ M = \int_L \rho(x,y) ds $$
    *   对 $y$ 轴的静矩 $M_y$:
        $$ M_y = \int_L x \cdot \rho(x,y) ds $$
        (每一小段质量 $\rho(x,y)ds$ 乘以其到 $y$ 轴的距离 $x$，然后沿曲线 $L$ 累加)
    *   对 $x$ 轴的静矩 $M_x$:
        $$ M_x = \int_L y \cdot \rho(x,y) ds $$
        (每一小段质量 $\rho(x,y)ds$ 乘以其到 $x$ 轴的距离 $y$，然后沿曲线 $L$ 累加)
    这里的 $ds$ 是弧长微元。

3.  **参数化曲线 $L$**：
    这是将曲线积分转化为普通定积分的关键步骤。根据曲线 $L$ 的方程，选择合适的参数化形式。
    *   **如果 $L$ 由参数方程给出**：
        $x = x(t)$
        $y = y(t)$
        其中参数 $t$ 的取值范围是 $t \in [\alpha, \beta]$。
    *   **如果 $L$ 由直角坐标显式方程给出**，例如 $y = f(x)$，$x \in [a, b]$：
        可以令 $x = t$，则 $y = f(t)$，参数 $t \in [a, b]$。
    *   **如果 $L$ 由极坐标方程给出**，例如 $r = r(\theta)$，$\theta \in [\theta_1, \theta_2]$：
        可以先转换为直角坐标参数方程：
        $x = r(\theta) \cos\theta$
        $y = r(\theta) \sin\theta$
        参数为 $\theta$，取值范围是 $\theta \in [\theta_1, \theta_2]$。

4.  **计算弧长微元 $ds$**：
    根据所选的参数化形式，计算 $ds$。
    *   **对于参数方程 $x=x(t), y=y(t)$**：
        首先计算 $x'(t) = \frac{dx}{dt}$ 和 $y'(t) = \frac{dy}{dt}$。
        则弧长微元为：
        $$ ds = \sqrt{[x'(t)]^2 + [y'(t)]^2} dt $$
    *   **对于直角坐标显式方程 $y=f(x)$** (参数化为 $x=t, y=f(t)$):
        $x'(t) = 1$, $y'(t) = f'(t)$
        $$ ds = \sqrt{1 + [f'(x)]^2} dx \quad (\text{或者 } \sqrt{1 + [f'(t)]^2} dt) $$
    *   **对于极坐标方程 $r=r(\theta)$** (参数化为 $x=r(\theta)\cos\theta, y=r(\theta)\sin\theta$):
        这会稍微复杂一点，但最终可以得到：
        $$ ds = \sqrt{[r(\theta)]^2 + [r'(\theta)]^2} d\theta $$
        其中 $r'(\theta) = \frac{dr}{d\theta}$。

5.  **将曲线积分转化为关于参数的定积分**：
    将参数方程 $x(t), y(t)$，线密度 $\rho(x(t), y(t))$ 以及弧长微元 $ds$ 代入到步骤 2 中的三个积分表达式中。
    *   总质量 $M$:
        $$ M = \int_{\alpha}^{\beta} \rho(x(t), y(t)) \sqrt{[x'(t)]^2 + [y'(t)]^2} dt $$
    *   对 $y$ 轴的静矩 $M_y$:
        $$ M_y = \int_{\alpha}^{\beta} x(t) \cdot \rho(x(t), y(t)) \sqrt{[x'(t)]^2 + [y'(t)]^2} dt $$
    *   对 $x$ 轴的静矩 $M_x$:
        $$ M_x = \int_{\alpha}^{\beta} y(t) \cdot \rho(x(t), y(t)) \sqrt{[x'(t)]^2 + [y'(t)]^2} dt $$

6.  **计算定积分**：
    分别计算 $M, M_y, M_x$ 这三个定积分。这可能涉及到各种积分技巧，如换元积分法、分部积分法、三角恒等变换等。

7.  **计算质心坐标**：
    将计算得到的 $M, M_y, M_x$ 的值代回到步骤 1 中的质心公式：
    $$ \bar{x} = \frac{M_y}{M} $$
    $$ \bar{y} = \frac{M_x}{M} $$
    得到最终的质心坐标 $(\bar{x}, \bar{y})$。

8.  **(可选但推荐) 利用对称性简化计算**：
    *   **如果曲线 $L$ 关于 $y$ 轴对称，并且线密度 $\rho(x,y)$ 关于 $x$ 是偶函数** (即 $\rho(-x,y) = \rho(x,y)$)，那么被积函数 $x \cdot \rho(x,y)$ 在计算 $M_y$ 时是关于 $x$ 的奇函数。此时，如果积分路径关于 $y$ 轴对称（例如完整的圆或对称的弧段），则 $M_y = 0$，从而 $\bar{x} = 0$。
    *   **如果曲线 $L$ 关于 $x$ 轴对称，并且线密度 $\rho(x,y)$ 关于 $y$ 是偶函数** (即 $\rho(x,-y) = \rho(x,y)$)，那么被积函数 $y \cdot \rho(x,y)$ 在计算 $M_x$ 时是关于 $y$ 的奇函数。此时，如果积分路径关于 $x$ 轴对称，则 $M_x = 0$，从而 $\bar{y} = 0$。
    *   **如果构件是均匀的** (即 $\rho(x,y) = \text{常数}$)，且形状具有几何对称性，则质心通常位于几何中心。但本题型明确给出线密度是非均匀的，所以不能直接用几何中心。
    利用对称性可以大大减少计算量，甚至可以直接得到某个静矩的值为零。

---

## 由面密度和方程求曲面型构件质心

**问题类型描述：**

已知一个由曲面方程 $\Sigma$ 定义的构件，以及其面密度函数 $\delta(x,y,z)$，求该构件的质心坐标 $(\bar{x}, \bar{y}, \bar{z})$。

---

**序章：审题与策略分析**

在动手计算之前，先花一分钟进行战略部署，这往往能让你事半功倍。

1.  **分析对称性（Symmetry Analysis）**：这是**最重要**的预处理步骤！
    *   **观察几何形状**：曲面 $\Sigma$ 是否关于某个坐标平面（如 yz-平面）、某条坐标轴（如 z-轴）或原点对称？
    *   **观察密度函数** $\delta(x,y,z)$：密度分布是否也具有同样的对称性？
        *   例如，如果 $\Sigma$ 关于 yz-平面（即 $x=0$ 平面）对称，我们就要看 $\delta(-x, y, z)$ 是否等于 $\delta(x, y, z)$。如果相等，则密度分布也对称。
    *   **下结论**：如果**几何形状**和**密度分布**同时关于某个平面、轴或点对称，则质心一定位于该对称元素上。
        *   若关于 yz-平面（$x=0$）对称，则 $\bar{x}=0$。
        *   若关于 z-轴对称，则 $\bar{x}=0, \bar{y}=0$。
        *   若关于原点对称，则 $(\bar{x}, \bar{y}, \bar{z}) = (0,0,0)$。
    这一步可以极大地减少我们的计算量。

**第一步：计算面积微元 dS**

这是所有曲面积分计算的**基础**，目标是把弯曲的 $dS$ 变成平面的 $dxdy$ 或 $dudv$。

1.  **选择方法**：根据曲面 $\Sigma$ 的方程形式，选择最优的“化曲为平”方法。
    *   **投影法**：如果曲面能表示为显函数形式，如 $z = f(x,y)$，这是首选。
        $$
        dS = \sqrt{1 + \left(\frac{\partial z}{\partial x}\right)^2 + \left(\frac{\partial z}{\partial y}\right)^2} \,dx\,dy
        $$
        投影到哪个平面，就对另外两个变量求偏导。
    *   **参数法**：如果曲面是柱面、球面、锥面等，或者方程是隐函数形式，参数法通常更强大、更通用。
        将曲面参数化为 $\vec{r}(u,v) = (x(u,v), y(u,v), z(u,v))$。
        $$
        dS = ||\vec{r}_u \times \vec{r}_v|| \,du\,dv
        $$

**第二步：计算总质量 M**

总质量是所有后续计算的分母，是物体的基本属性。

1.  **写出积分表达式**：根据定义，总质量是密度函数在整个曲面上的积分。
    $$
    M = \iint_\Sigma \delta(x,y,z) \,dS
    $$

2.  **转化为二重积分**：将第一步得到的 $dS$ 表达式代入，并把 $x,y,z$ 和 $\delta(x,y,z)$ 都换成相应的投影坐标（如 $x,y$）或参数（如 $u,v$）。
    *   **投影法**：$M = \iint_{D_{xy}} \delta(x,y,f(x,y)) \sqrt{1+f_x^2+f_y^2} \,dx\,dy$
    *   **参数法**：$M = \iint_{D_{uv}} \delta(x(u,v), \dots) ||\vec{r}_u \times \vec{r}_v|| \,du\,dv$

3.  **确定积分区域**：确定二重积分的积分域 $D_{xy}$ 或 $D_{uv}$。这个区域通常由题目给出的曲面边界（如 $1 \le z \le 2$）来决定。

4.  **计算积分**：选择合适的坐标系（如极坐标）来计算这个二重积分。

**第三步：计算一阶矩（静矩）**

一阶矩衡量了质量相对于各个坐标平面的分布情况，是计算质心坐标的分子。

1.  **写出积分表达式**：根据定义，一阶矩是在质量积分的被积函数中多乘一个坐标。
    *   关于 yz-平面的矩：$M_{yz} = \iint_\Sigma x \cdot \delta(x,y,z) \,dS$
    *   关于 xz-平面的矩：$M_{xz} = \iint_\Sigma y \cdot \delta(x,y,z) \,dS$
    *   关于 xy-平面的矩：$M_{xy} = \iint_\Sigma z \cdot \delta(x,y,z) \,dS$
    **注意**：在序章的对称性分析中，如果确定了某个质心坐标为0（比如 $\bar{x}=0$），则对应的一阶矩（$M_{yz}$）也必为0，无需计算。

2.  **转化为二重积分并计算**：这个过程与计算总质量 M 完全一样，只是被积函数不同而已。同样需要代换 $dS$、坐标和密度函数，确定积分区域，然后计算。

**第四步：组装质心坐标**

这是最后的“总装”环节，将前面计算出的零件组合起来。

1.  **使用质心公式**：
    $$
    \bar{x} = \frac{M_{yz}}{M}, \quad \bar{y} = \frac{M_{xz}}{M}, \quad \bar{z} = \frac{M_{xy}}{M}
    $$
    将第二步和第三步计算出的结果代入即可。

2.  **最终答案**：写出质心坐标 $(\bar{x}, \bar{y}, \bar{z})$。

---

## 在空间中给定的曲线上计算曲线积分

曲线积分主要分为两类：**第一类曲线积分（对弧长的曲线积分）** 和 **第二类曲线积分（对坐标的曲线积分）**。它们有不同的物理意义和计算方法。

---

### 第一类曲线积分 (对弧长的曲线积分)

形式：$\int_L f(x,y,z) ds$
物理意义：如果 $f(x,y,z)$ 是空间曲线 $L$ 的线密度，则积分为曲线的质量；如果 $f(x,y,z)=1$，则积分为曲线的长度。
特点：积分值与曲线 $L$ 的方向无关。

**通用解题步骤 (参数化法)**:

1.  **参数化空间曲线 $L$**：
    这是最核心的一步。你需要将空间曲线 $L$ 表示为参数方程的形式：
    $x = x(t)$
    $y = y(t)$
    $z = z(t)$
    其中参数 $t$ 的取值范围是 $t \in [\alpha, \beta]$。
    *   **如果曲线直接由参数方程给出**：直接使用。
    *   **如果曲线是两个曲面 $F(x,y,z)=0$ 和 $G(x,y,z)=0$ 的交线**：
        你需要从这两个方程中消去某些变量，或者引入一个参数来表达 $x,y,z$。这通常是比较有挑战性的一步，可能需要具体问题具体分析。例如，如果其中一个曲面是柱面 $x^2+y^2=R^2$，可以尝试令 $x=R\cos t, y=R\sin t$，然后代入另一个曲面方程求出 $z$ 关于 $t$ 的表达式。

2.  **计算弧长微元 $ds$**：
    根据参数方程，计算 $x'(t) = \frac{dx}{dt}$, $y'(t) = \frac{dy}{dt}$, $z'(t) = \frac{dz}{dt}$。
    则弧长微元为：
    $$ ds = \sqrt{[x'(t)]^2 + [y'(t)]^2 + [z'(t)]^2} dt $$

3.  **将被积函数 $f(x,y,z)$ 用参数 $t$ 表示**：
    将 $x=x(t), y=y(t), z=z(t)$ 代入到被积函数 $f(x,y,z)$ 中，得到 $f(x(t), y(t), z(t))$。

4.  **将曲线积分转化为关于参数 $t$ 的定积分**：
    $$ \int_L f(x,y,z) ds = \int_{\alpha}^{\beta} f(x(t), y(t), z(t)) \sqrt{[x'(t)]^2 + [y'(t)]^2 + [z'(t)]^2} dt $$

5.  **计算定积分**：
    计算得到的关于 $t$ 的定积分。

**适用领域**：
*   计算空间曲线的质量、长度。
*   当被积函数 $f(x,y,z)$ 和曲线 $L$ 本身都比较适合用参数方程描述时。

---

### 第二类曲线积分 (对坐标的曲线积分)

形式：$\int_L P(x,y,z)dx + Q(x,y,z)dy + R(x,y,z)dz$
物理意义：如果 $\mathbf{F} = (P, Q, R)$ 是一个力场，则该积分表示力 $\mathbf{F}$ 沿有向曲线 $L$所做的功。
特点：积分值与曲线 $L$ 的方向有关。如果积分方向相反，积分值变号。

**解法一：参数化法 (最通用)**

1.  **参数化空间曲线 $L$ 并确定方向**：
    与第一类曲线积分一样，将空间曲线 $L$ 表示为参数方程：
    $x = x(t)$
    $y = y(t)$
    $z = z(t)$
    参数 $t$ 的取值范围是 $t \in [\alpha, \beta]$。
    **特别注意**：参数 $t$ 从 $\alpha$ 到 $\beta$ 的变化方向必须与曲线 $L$ 的指定方向一致。如果参数化的自然方向与 $L$ 的方向相反，需要在最后结果前加负号，或者调整参数的积分上下限（例如从 $\beta$ 积到 $\alpha$）。

2.  **计算 $dx, dy, dz$**：
    $dx = x'(t) dt = \frac{dx}{dt} dt$
    $dy = y'(t) dt = \frac{dy}{dt} dt$
    $dz = z'(t) dt = \frac{dz}{dt} dt$

3.  **将被积函数中的 $P, Q, R$ 用参数 $t$ 表示**：
    将 $x=x(t), y=y(t), z=z(t)$ 代入到 $P(x,y,z), Q(x,y,z), R(x,y,z)$ 中，得到 $P(x(t),y(t),z(t))$, $Q(x(t),y(t),z(t))$, $R(x(t),y(t),z(t))$。

4.  **将曲线积分转化为关于参数 $t$ 的定积分**：
    $$ \int_L Pdx + Qdy + Rdz = \int_{\alpha}^{\beta} \left[ P(x(t),y(t),z(t))x'(t) + Q(x(t),y(t),z(t))y'(t) + R(x(t),y(t),z(t))z'(t) \right] dt $$

5.  **计算定积分**：
    计算得到的关于 $t$ 的定积分。

**适用领域**：
*   几乎所有第二类曲线积分问题都可以用此方法解决，特别是当曲线不易用显式方程表达，或者被积函数复杂时。
*   计算力场做功等。

**解法二：利用格林公式 (Green's Theorem) - 仅适用于平面曲线**

如果曲线 $L$ 是一条**平面闭合曲线**，且 $P(x,y), Q(x,y)$ 在 $L$ 所围成的平面区域 $D$ 上具有一阶连续偏导数，则：
$$ \oint_L Pdx + Qdy = \iint_D \left( \frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y} \right) dxdy $$
其中 $L$ 的方向为取区域 $D$ 在其左侧的**正方向**（通常是逆时针）。

**通用解题步骤 (格林公式)**:

1.  **判断适用条件**：
    *   曲线 $L$ 必须是平面上的简单闭合曲线 (不自交)。
    *   函数 $P(x,y)$ 和 $Q(x,y)$ 在 $L$ 及其内部区域 $D$ 上具有一阶连续偏导数。
    *   题目是计算 $\oint_L Pdx + Qdy$ (即 $R=0$ 且问题在二维平面)。

2.  **确定积分区域 $D$ 和 $L$ 的方向**：
    $D$ 是 $L$ 所围成的平面区域。确保 $L$ 的方向是正方向（通常为逆时针）。如果题目给定的方向是反向，则计算结果需取相反数。

3.  **计算偏导数**：
    计算 $\frac{\partial Q}{\partial x}$ 和 $\frac{\partial P}{\partial y}$。

4.  **将被积函数代入二重积分**：
    被积函数为 $\left( \frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y} \right)$。

5.  **计算二重积分 $\iint_D \left( \frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y} \right) dxdy$**：
    使用计算二重积分的方法（例如化为累次积分，或使用极坐标变换）。

**适用领域**：
*   计算平面闭合曲线上的第二类曲线积分。
*   当 $\frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y}$ 的形式比原积分简单，或者为常数时，此方法特别有效。
*   用于计算平面区域的面积 (例如取 $P=-y/2, Q=x/2$，则 $\frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y} = 1$，积分为面积)。

**解法三：利用斯托克斯公式 (Stokes' Theorem) - 适用于空间开曲面边界的第二类曲线积分**

如果 $L$ 是一条空间分段光滑的**简单闭合曲线**，并且是以 $L$ 为边界的某个分片光滑的**有向曲面 $S$** 的边界，$\mathbf{F} = (P, Q, R)$ 在包含 $S$ 的某个空间区域内具有一阶连续偏导数，则：
$$ \oint_L Pdx + Qdy + Rdz = \iint_S (\nabla \times \mathbf{F}) \cdot d\mathbf{S} $$
其中 $\nabla \times \mathbf{F}$ 是向量场 $\mathbf{F}$ 的旋度，其分量为：
$$ \nabla \times \mathbf{F} = \left( \frac{\partial R}{\partial y} - \frac{\partial Q}{\partial z} \right) \mathbf{i} + \left( \frac{\partial P}{\partial z} - \frac{\partial R}{\partial x} \right) \mathbf{j} + \left( \frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y} \right) \mathbf{k} $$
$d\mathbf{S} = \mathbf{n} dS$，其中 $\mathbf{n}$ 是曲面 $S$ 的单位法向量，其方向与曲线 $L$ 的方向符合右手螺旋法则。

**通用解题步骤 (斯托克斯公式)**:

1.  **判断适用条件**：
    *   曲线 $L$ 是空间中的简单闭合曲线。
    *   函数 $P, Q, R$ 及其一阶偏导数连续。
    *   题目是计算 $\oint_L Pdx + Qdy + Rdz$。

2.  **选择一个以 $L$ 为边界的简单曲面 $S$**：
    选择一个计算起来比较方便的曲面 $S$。例如，如果 $L$ 是平面曲线，可以选择 $L$ 所围成的平面区域作为 $S$；如果 $L$ 在某个球面上，可以选取球面的一部分。

3.  **确定曲面 $S$ 的法向量方向**：
    法向量 $\mathbf{n}$ 的方向需要与曲线 $L$ 的方向通过右手定则相匹配 (手指沿 $L$ 方向，大拇指指向 $\mathbf{n}$ 方向)。

4.  **计算旋度 $\nabla \times \mathbf{F}$**。

5.  **将被积向量场和面积微元代入第二类曲面积分**：
    计算第二类曲面积分 $\iint_S (\nabla \times \mathbf{F}) \cdot d\mathbf{S}$。这通常需要参数化曲面 $S$，计算法向量，然后化为二重积分。

**适用领域**：
*   计算空间闭合曲线上的第二类曲线积分。
*   当计算旋度后，曲面积分比原曲线积分更容易计算时。
*   特别是当旋度 $\nabla \times \mathbf{F} = \mathbf{0}$ (即场是保守场或无旋场) 时，如果 $L$ 是闭曲线，则积分值为0 (需要满足单连通区域条件)。

**解法四：利用积分与路径无关的条件 (适用于保守场/梯度场)**

如果向量场 $\mathbf{F} = (P, Q, R)$ 是一个**保守场 (或称梯度场)**，即存在一个标量函数 (势函数) $u(x,y,z)$ 使得 $\nabla u = \mathbf{F}$ (即 $\frac{\partial u}{\partial x} = P, \frac{\partial u}{\partial y} = Q, \frac{\partial u}{\partial z} = R$)，那么第二类曲线积分与路径无关，只取决于起点 $A(x_0, y_0, z_0)$ 和终点 $B(x_1, y_1, z_1)$：
$$ \int_L Pdx + Qdy + Rdz = u(B) - u(A) = u(x_1, y_1, z_1) - u(x_0, y_0, z_0) $$
判断场是否保守的条件 (在单连通区域内)：
$\frac{\partial R}{\partial y} = \frac{\partial Q}{\partial z}$, $\frac{\partial P}{\partial z} = \frac{\partial R}{\partial x}$, $\frac{\partial Q}{\partial x} = \frac{\partial P}{\partial y}$ (即 $\nabla \times \mathbf{F} = \mathbf{0}$)。

**通用解题步骤 (积分与路径无关)**:

1.  **判断场是否保守**：
    计算上述偏导数是否两两相等。如果相等，则场是保守场 (在合适的区域内)。

2.  **求势函数 $u(x,y,z)$** (如果需要显式计算积分值)：
    通过积分求解方程组 $\frac{\partial u}{\partial x} = P, \frac{\partial u}{\partial y} = Q, \frac{\partial u}{\partial z} = R$。
    例如，先对 $P$ 关于 $x$ 积分：$u(x,y,z) = \int P(x,y,z) dx + \phi(y,z)$。
    然后对结果关于 $y$ 求偏导，令其等于 $Q$，求出 $\frac{\partial \phi}{\partial y}$，再积分得到 $\phi(y,z)$ 的一部分。
    以此类推，直到确定 $u(x,y,z)$ (可以差一个任意常数，不影响最终结果)。

3.  **确定曲线 $L$ 的起点 $A$ 和终点 $B$**。

4.  **计算积分值**：
    代入起点和终点的坐标到势函数中：$\text{积分值} = u(B) - u(A)$。
    **特别注意**：如果曲线 $L$ 是**闭合曲线**，则起点和终点相同 ($A=B$)，此时如果场是保守的，积分值为 $0$。

**适用领域**：
*   当被积表达式 $Pdx+Qdy+Rdz$ 恰好是一个全微分 $du$ 时。
*   当判断出场是保守场时，计算变得非常简单，尤其是对于闭合路径。

---

总结一下：

*   **第一类曲线积分**主要用**参数化法**。
*   **第二类曲线积分**：
    *   **参数化法**是最通用的。
    *   **格林公式**用于平面闭合曲线。
    *   **斯托克斯公式**用于空间闭合曲线，将其转化为曲面积分。
    *   **积分与路径无关的条件**用于保守场，大大简化计算。

---

## 求由坐标平面与第一卦限内某曲面之切平面所围四面体最小体积

**问题类型描述：**

求由三个坐标平面 $x=0$, $y=0$, $z=0$ 以及一个给定的曲面 $F(x,y,z)=C$ 在第一卦限（$x>0, y>0, z>0$）的切平面所围成的立体（通常是一个四面体）的最小体积。

**第一步：确定任意切点的切平面方程**

这是我们的出发点，因为切平面是变化的，它的变化取决于切点的选择。

1.  **设任意切点**：在曲面 $F(x,y,z)=C$ 的第一卦限部分上，任取一点 $P_0(x_0, y_0, z_0)$ 作为切点。请记住，这里的 $(x_0, y_0, z_0)$ 是我们要求解的变量。

2.  **计算曲面梯度**：梯度向量 $\nabla F$ 给出了曲面的法向量方向。
    $$
    \nabla F = \left( \frac{\partial F}{\partial x}, \frac{\partial F}{\partial y}, \frac{\partial F}{\partial z} \right)
    $$
    在切点 $P_0$ 处的法向量即为 $\vec{n} = \nabla F(x_0, y_0, z_0)$。

3.  **写出切平面方程**：使用点法式方程，切平面方程为：
    $$
    \frac{\partial F}{\partial x}\bigg|_{(x_0,y_0,z_0)}(x-x_0) + \frac{\partial F}{\partial y}\bigg|_{(x_0,y_0,z_0)}(y-y_0) + \frac{\partial F}{\partial z}\bigg|_{(x_0,y_0,z_0)}(z-z_0) = 0
    $$
    **技巧**：通常可以对这个方程进行化简。把含有 $x, y, z$ 的项留在左边，常数项移到右边。很多时候，右边的常数项可以利用“切点 $P_0$ 在曲面上”这一事实（即 $F(x_0, y_0, z_0)=C$）来简化。

**第二步：建立关于切点坐标的体积函数**

我们的目标是求体积的最小值，所以必须先得到体积的表达式。

1.  **求切平面在三轴上的截距**：
    *   令 $y=0, z=0$，从切平面方程中解出 $x$ 轴截距，我们称之为 $X$。
    *   令 $x=0, z=0$，解出 $y$ 轴截距，我们称之为 $Y$。
    *   令 $x=0, y=0$，解出 $z$ 轴截距，我们称之为 $Z$。
    这里的 $X, Y, Z$ 通常会是包含 $x_0, y_0, z_0$ 的表达式。

2.  **写出四面体体积公式**：由坐标平面和切平面围成的四面体，其体积为：
    $$
    V = \frac{1}{6} |X \cdot Y \cdot Z|
    $$
    因为我们是在第一卦限，截距 $X, Y, Z$ 均为正，所以绝对值可以去掉。将上一步求得的 $X, Y, Z$ 的表达式代入，我们就得到了体积函数 $V(x_0, y_0, z_0)$。

**第三步：明确目标函数和约束条件**

这是将几何问题转化为数学分析问题的关键一步。

1.  **确定目标函数 $f(x_0, y_0, z_0)$**：
    我们的最终目标是求 $V(x_0, y_0, z_0)$ 的最小值。但有时 $V$ 的表达式很复杂（比如一个分式）。我们可以通过观察，将其转化为一个更简单的等价问题。
    *   **例如**：如果 $V = \frac{\text{常数}}{x_0 y_0 z_0}$，那么求 $V$ 的最小值就等价于求分母 $f(x_0, y_0, z_0) = x_0 y_0 z_0$ 的最大值。
    选择一个形式最简单的函数作为我们的**目标函数** $f$。

2.  **确定约束条件 $g(x_0, y_0, z_0) = 0$**：
    变量 $x_0, y_0, z_0$ 不是可以任意取值的，它们必须满足一个条件：切点 $P_0(x_0, y_0, z_0)$ 必须在给定的曲面上。
    所以，约束条件就是曲面方程本身：
    $$
    g(x_0, y_0, z_0) = F(x_0, y_0, z_0) - C = 0
    $$

**第四步：使用拉格朗日乘数法求解**

这是解决条件极值问题的标准“大杀器”。

1.  **构造拉格朗日函数**：
    $$
    L(x_0, y_0, z_0, \lambda) = f(x_0, y_0, z_0) + \lambda \cdot g(x_0, y_0, z_0)
    $$

2.  **建立方程组**：对 $L$ 的所有变量（包括 $\lambda$）求偏导，并令它们等于零：
    $$
    \begin{cases} \frac{\partial L}{\partial x_0} = \frac{\partial f}{\partial x_0} + \lambda \frac{\partial g}{\partial x_0} = 0 \\ \frac{\partial L}{\partial y_0} = \frac{\partial f}{\partial y_0} + \lambda \frac{\partial g}{\partial y_0} = 0 \\ \frac{\partial L}{\partial z_0} = \frac{\partial f}{\partial z_0} + \lambda \frac{\partial g}{\partial z_0} = 0 \\ \frac{\partial L}{\partial \lambda} = g(x_0, y_0, z_0) = 0 \end{cases}
    $$

3.  **解方程组**：这是最考验代数计算能力的一步。通常的策略是：
    *   利用前三个方程消去 $\lambda$，得到 $x_0, y_0, z_0$ 之间的比例关系。
    *   将这个比例关系代入第四个方程（约束条件），解出 $x_0, y_0, z_0$ 的具体值。

**第五步：回代计算最小体积**

千万不要忘记这最后一步，解出 $(x_0, y_0, z_0)$ 只是中间过程，我们的目标是体积。

1.  将第四步解出的唯一可能极值点 $(x_0, y_0, z_0)$ 的坐标，代回到**第二步**建立的体积函数 $V(x_0, y_0, z_0)$ 中。
2.  计算出的数值，即为所求的最小体积。

---

## 求解被两个曲面（或平面）所截的柱面部分的面积

**问题类型描述：**

给定一个母线平行于某个坐标轴的柱面（例如，平行于 $z$ 轴的柱面 $f(x,y)=C$），求它介于两个曲面（通常是 $z=g_1(x,y)$ 和 $z=g_2(x,y)$）之间的那一部分的面积。

---

**第一步：识别曲面类型并选择参数化方法**

1.  **分析柱面方程**：确定柱面的形状和轴向。
    *   形如 $x^2 + y^2 = R^2$ 的是**圆柱面**，轴是 $z$ 轴。
    *   形如 $\frac{x^2}{a^2} + \frac{y^2}{b^2} = 1$ 的是**椭圆柱面**，轴是 $z$ 轴。
    *   形如 $y=f(x)$ 或 $x=f(y)$ 的是**抛物柱面**等其他类型的柱面。
    *   **关键**：确定母线平行于哪个轴。如果方程只含 $x, y$，则母线平行于 $z$ 轴；只含 $y, z$，则平行于 $x$ 轴，以此类推。

2.  **选择最佳参数**：对于柱面，**参数化**是计算其面积最自然、最强大的方法。
    *   **对于圆柱面 $x^2+y^2=R^2$**：最常用的参数是柱坐标中的角 $\theta$ 和高 $z$。
        $$
        \begin{cases} x = R \cos\theta \\ y = R \sin\theta \\ z = z \end{cases}
        $$
        这里的 $\theta$ 和 $z$ 就是我们选定的两个独立参数。
    *   **对于椭圆柱面 $\frac{x^2}{a^2} + \frac{y^2}{b^2} = 1$**：使用椭圆的参数方程。
        $$
        \begin{cases} x = a \cos\theta \\ y = b \sin\theta \\ z = z \end{cases}
        $$
    *   **对于一般柱面 $y=f(x)$**：可以直接用 $x$ 和 $z$ 作为参数。
        $$
        \begin{cases} x = x \\ y = f(x) \\ z = z \end{cases}
        $$
    总之，我们的目标是用两个独立的参数（我们称之为 $u, v$）来表示曲面上的点 $(x, y, z)$。

**第二步：计算面积微元 dS**

这是将曲面积分转化为我们熟悉的二重积分的核心步骤。

1.  **写出曲面的参数向量**：将上一步的参数方程写成向量形式 $\vec{r}(u,v)$。
    *   例如，对于圆柱面，$\vec{r}(\theta, z) = (R\cos\theta, R\sin\theta, z)$。

2.  **求切向量**：计算参数向量 $\vec{r}$ 对两个参数 $u, v$ 的偏导数，得到曲面上沿两个参数方向的切向量 $\vec{r}_u$ 和 $\vec{r}_v$。
    $$
    \vec{r}_u = \frac{\partial \vec{r}}{\partial u} \quad \text{和} \quad \vec{r}_v = \frac{\partial \vec{r}}{\partial v}
    $$
    *   例如，对于圆柱面，$\vec{r}_\theta = (-R\sin\theta, R\cos\theta, 0)$，$\vec{r}_z = (0, 0, 1)$。

3.  **计算法向量（叉积）**：计算两个切向量的叉积，得到曲面的法向量。
    $$
    \vec{n} = \vec{r}_u \times \vec{r}_v
    $$

4.  **计算法向量的模**：计算这个法向量的长度（模）。
    $$
    ||\vec{r}_u \times \vec{r}_v||
    $$

5.  **写出面积微元 dS**：根据第一类曲面积分的公式，面积微元 $dS$ 等于法向量的模乘以两个参数的微分。
    $$
    dS = ||\vec{r}_u \times \vec{r}_v|| \, du \, dv
    $$
    *   例如，对于半径为 $R$ 的圆柱面，我们总能算出 $||\vec{r}_\theta \times \vec{r}_z|| = R$。所以 $dS = R \, d\theta \, dz$。这是一个非常有用的结论，可以记下来。

**第三步：确定参数的积分区域**

这是为最终的二重积分“画地盘”的一步。

1.  **确定一个参数的范围**：一个参数的范围通常是由柱面自身的完整性决定的。
    *   对于完整的圆柱或椭圆柱面，角度参数 $\theta$ 的范围通常是 $[0, 2\pi]$。
    *   对于 $y=f(x)$ 型柱面，如果题目有要求 $x$ 的范围（比如 $x$ from $a$ to $b$），那么参数 $x$ 的范围就是 $[a, b]$。

2.  **确定另一个参数的范围**：另一个参数（通常是母线方向的坐标，如 $z$）的范围是由给定的两个“切割”曲面决定的。
    *   设切割曲面为 $z_{\text{下}} = g_1(x,y)$ 和 $z_{\text{上}} = g_2(x,y)$。
    *   你需要将这两个切割曲面的方程，用**第一步**中选定的参数来表示。也就是说，把 $x, y$ 替换成参数的表达式。
    *   这样，你就得到了这个参数的积分上下限，而这个上下限通常会是另一个参数的函数。
    *   例如，对于圆柱面，将 $x = R\cos\theta, y = R\sin\theta$ 代入 $g_1, g_2$，得到 $z$ 的范围是 $g_1(R\cos\theta, R\sin\theta) \le z \le g_2(R\cos\theta, R\sin\theta)$。

**第四步：建立并计算二重积分**

1.  **写出面积积分公式**：曲面面积 $A = \iint_\Sigma dS$。
2.  **转化为二重积分**：将 $dS$ 和积分区域代入，得到一个关于参数 $u, v$ 的二重积分。
    $$
    A = \iint_D ||\vec{r}_u \times \vec{r}_v|| \, du \, dv
    $$
    其中 $D$ 是第三步确定的参数积分区域。

3.  **计算积分**：按照二重积分的计算法则（通常是化为二次积分）进行计算。
    *   先对那个积分限是函数的变量进行积分（内层积分）。
    *   再对积分限是常数的变量进行积分（外层积分）。
    *   在计算过程中，可能会用到三角函数的降幂公式、换元法等定积分技巧。

---

## 求向量场穿过曲面的总通量

**给定一个三维空间中的向量场 $F(x,y,z) = (P(x,y,z), Q(x,y,z), R(x,y,z))$ 和一个有指定方向（法向量方向 $n$）的曲面 $S$，求解向量场 $F$ 穿过曲面 $S$ 的总通量 $Φ$。**

其数学表达式为：
$$
\Phi = \iint_S \mathbf{F} \cdot \mathbf{n} \,dS \quad \text{或写作} \quad \Phi = \iint_S P \,dy \wedge dz + Q \,dz \wedge dx + R \,dx \wedge dy
$$

在高等数学中，有一个非常标准的名字：**对坐标的曲面积分**，也常被称为**第二类曲面积分**。
从物理和几何的角度看，它计算的是**向量场穿过一个指定方向的曲面的通量 (Flux)**。

通用解题步骤（“三步转换法”）

解决这类问题的核心思想，就是我之前提到的 **“拉平”** 操作，也就是**参数化**。无论题目中的曲面 $S$ 长得多么奇形怪状，我们都可以通过下面这套标准的“三步转换法”将它转化为一个平面上的二重积分问题来解决。

---

 **第一步：曲面参数化 (找到“设计图”和“对应法则”)**

这一步的目标是，用两个独立的参数（我们通常叫 $u$ 和 $v$）来表示曲面 $S$ 上的任意一点的坐标 $(x, y, z)$。

1.  **选择参数，写出参数方程 $\mathbf{r}(u, v)$**：
    *   如果曲面由 $z = f(x, y)$ 给出，最自然的选择是令 $x = u, y = v$，则 $z = f(u, v)$。
        参数方程为：$\mathbf{r}(u, v) = (u, v, f(u, v))$。
    *   如果曲面由 $y = g(x, z)$ 给出（就像我们刚才的例题 $y=e^x$），最自然的选择是令 $x = u, z = v$，则 $y = g(u, v)$。
        参数方程为：$\mathbf{r}(u, v) = (u, g(u, v), v)$。
    *   如果曲面由 $x = h(y, z)$ 给出，最自然的选择是令 $y = u, z = v$，则 $x = h(u, v)$。
        参数方程为：$\mathbf{r}(u, v) = (h(u, v), u, v)$。

2.  **确定参数范围 $D$**：
    根据题目给出的 $x, y, z$ 的取值范围，反推出参数 $u, v$ 的取值范围。这个范围 $D$ 就是曲面 $S$ 在 $uv$ 参数平面上的“投影”，也就是我们最终要进行二重积分的区域。

---

 **第二步：计算法向量并确定方向 (制作“施工工具”)**

这一步的目标是计算出代表曲面方向和面积微元关系的“关键工具”——法向量 $\mathbf{N}$。

1.  **计算偏导数**：
    对参数方程 $\mathbf{r}(u, v)$ 分别求关于 $u$ 和 $v$ 的偏导数：
    $$
    \mathbf{r}_u = \frac{\partial \mathbf{r}}{\partial u}, \quad \mathbf{r}_v = \frac{\partial \mathbf{r}}{\partial v}
    $$

2.  **计算叉乘得到法向量 $\mathbf{N}$**：
    法向量 $\mathbf{N}$ 就是这两个偏导数向量的叉乘：
    $$
    \mathbf{N} = \mathbf{r}_u \times \mathbf{r}_v = \begin{vmatrix} \mathbf{i} & \mathbf{j} & \mathbf{k} \\ \frac{\partial x}{\partial u} & \frac{\partial y}{\partial u} & \frac{\partial z}{\partial u} \\ \frac{\partial x}{\partial v} & \frac{\partial y}{\partial v} & \frac{\partial z}{\partial v} \end{vmatrix}
    $$

3.  **核对法向量方向 (最关键、最易错的一步！)**：
    将计算出的法向量 $\mathbf{N}$ 与题目要求的方向 $\mathbf{n}$ 进行比较。
    *   **“向上”** 通常指法向量的 $z$ 分量为正。
    *   **“向外”** (例如柱面或球面) 通常指法向量的方向背离中心轴或中心点。
    *   **“远离某平面”** (例如远离 $yoz$ 平面) 通常指法向量的 $x$ 分量与曲面本身 $x$ 坐标的符号一致。
    
    **判断法则**：如果 $\mathbf{N}$ 的方向与题目要求的方向 $\mathbf{n}$ **一致**，则直接使用 $\mathbf{N}$。如果**相反**，则需要在后续计算中取其相反向量，即使用 $-\mathbf{N}$。

---

 **第三步：转换并计算二重积分 (开始“施工”)**

现在万事俱备，我们可以把原始的、抽象的曲面积分，转换成一个具体的、可计算的二重积分。

1.  **替换向量场 $\mathbf{F}$**：
    将参数方程 $x(u,v), y(u,v), z(u,v)$ 代入到向量场 $\mathbf{F}$ 中，得到用参数 $u, v$ 表示的向量场 $\mathbf{F}(\mathbf{r}(u, v))$。

2.  **计算点积**：
    计算上一步得到的向量场与我们确定的法向量（注意方向！）的点积：
    $$
    \text{被积函数} = \mathbf{F}(\mathbf{r}(u, v)) \cdot (\pm \mathbf{N})
    $$
    点积的结果是一个关于 $u, v$ 的普通二元函数。

3.  **建立并求解二重积分**：
    最终的通量 $Φ$ 就是这个点积结果在参数区域 $D$ 上的二重积分：
    $$
    \Phi = \iint_D \left( \mathbf{F}(\mathbf{r}(u, v)) \cdot (\pm \mathbf{N}) \right) \,du \,dv
    $$
    接下来就是你熟悉的二重积分计算了。

---

# 第12章 无穷级数

## 常数项级数

### 收敛的必要条件：发散检验法

对于一个无穷级数 ∑uₙ，如果它的部分和数列 {Sₙ} 的极限存在且为一个有限的数 S，即 lim (n→∞) Sₙ = S，那么我们就称这个级数是收敛的，并且它的和就是 S。
如果这个极限不存在，或者极限是无穷大，我们就称这个级数是发散的。

对于所有等比级数 a + aq + aq² + ...，有一个非常著名的结论：
- 当公比 q 的绝对值 **小于1** (即 -1 < q < 1) 时，级数 **收敛**。
- 它的和是：**S = a / (1 - q)** (首项 / (1 - 公比))

如果级数 ∑uₙ 收敛，那么它的通项 uₙ 必须满足 lim (n→∞) uₙ = 0。

- 一个级数收敛，它的通项 uₙ 极限必须是 0。
- 那么，如果一个级数的通项 uₙ 极限不等于 0（或者极限根本不存在），我们就可以判定这个级数一定是发散的！

---

### 比较判别法

如果两个正项级数的通项 uₙ 和 vₙ 是“同阶”的无穷小，那么它们的敛散性应该是一样的。

**具体操作：**  
计算 lim (n→∞) (uₙ / vₙ)。

1. 如果极限等于一个**常数 c** (并且 c > 0)，说明 uₙ 和 vₙ 下降的速度“差不多”，它们是同阶的。  
    **结论：∑ uₙ 和 ∑ vₙ 同敛散。** (即要么都收敛，要么都发散)
    
2. 如果极限等于 **0**，说明 uₙ 比 vₙ 下降得“快得多”。  
    **结论：如果 ∑ vₙ 收敛，那么 ∑ uₙ 也收敛。**
    
3. 如果极限等于 **∞**，说明 uₙ 比 vₙ 下降得“慢得多”。  
    **结论：如果 ∑ vₙ 发散，那么 ∑ uₙ 也发散。**

比较判别法的精髓在于选择一个合适的“标杆”级数。我们现在有两个最重要的标杆：

- **p-级数 ∑ 1/nᵖ**：当 p > 1 时收敛，当 p ≤ 1 时发散。(∑ 1/n² 是 p=2 的情况，收敛；∑ 1/n 是 p=1 的情况，发散)
    
- **等比级数 ∑ arⁿ⁻¹**：当 |r| < 1 时收敛，当 |r| ≥ 1 时发散。

**提示：**

1. 写出通项 uₙ。
    
2. 用“抓大头”法，分子看最高次幂，分母看最高次幂，来确定 uₙ 大概和 1/n 的多少次方是“同阶”的，以此来选择你的标杆 vₙ。
    
3. 计算 lim (uₙ / vₙ)，并根据结果和标杆的敛散性下结论

---

### 比值判别法

通过计算 lim (n→∞) uₙ₊₁ / uₙ (后一项比前一项) 来判断。
特别擅长对付含有阶乘 n! 和指数 aⁿ 的级数。

我们不要求它的每一项比值 uₙ₊₁ / uₙ 都是一个固定的常数，但我们可以看看当 n 趋于无穷大的时候，这个比值的**极限**是多少。这个极限，我们就可以看作是这个级数在“无穷远处”的“渐近公比”。

**这个“渐近公比”我们记为 ρ 。**  
ρ = lim (n→∞) |uₙ₊₁ / uₙ|  
(对于正项级数，绝对值可以不加)

**判定的法则就和等比级数几乎一模一样：**

1. **如果 ρ < 1：**
    
    - **直观理解：** 在无穷远处，后一项大约是前一项的 ρ 倍，ρ 是个小于1的数。这说明从某一项开始，级数就像一个公比小于1的等比级数一样，各项在飞快地缩小。这个“刹车”踩得足够猛！
        
    - **结论：** 级数 **收敛**。
        
2. **如果 ρ > 1 (或者 ρ = ∞)：**
    
    - **直观理解：** 在无穷远处，后一项比前一项还要大。这说明项不仅没有变小趋于0，反而在不断变大。连收敛的必要条件 lim uₙ = 0都满足不了。
        
    - **结论：** 级数 **发散**。
        
3. **如果 ρ = 1：**
    
    - **直观理解：** 在无穷远处，后一项和前一项差不多大。这个“刹车”踩得太温柔了，我们不确定它最后能不能刹住。它可能收敛，也可能发散。
        
    - **结论：** 比值法**失效**！我们需要用其他方法（比如回到我们之前学的比较法）来判断。
        

**一句话总结：算比值极限，小于1收敛，大于1发散，等于1失效。**

---

### 根值判别法

通过计算 lim (n→∞) ⁿ√uₙ (对通项开 n 次方) 来判断。
特别擅长对付通项整体n次方 (....)ⁿ 的级数。

根值判别法的操作和结论与比值法几乎一模一样，只不过是把求 uₙ₊₁ / uₙ 的极限换成了求 ⁿ√uₙ 的极限。

**快速地看一个根值法的例子，你马上就能理解：**

**判定 ∑ (n / (2n+1))ⁿ 的敛散性。**  

看到通项是 (...)ⁿ 的形式，立刻想到根值法。  
uₙ = (n / (2n+1))ⁿ  
计算 lim (n→∞) ⁿ√uₙ：  
ρ = lim (n→∞) ⁿ√[(n / (2n+1))ⁿ]  
= lim (n→∞) n / (2n+1)  
= 1/2  
因为 ρ = 1/2 < 1，所以级数**收敛**。 

---

### 交错级数：莱布尼茨判别法

这个判别法非常直观，也非常好用。它说，一个交错级数 ∑ (-1)ⁿ⁻¹ uₙ 只要满足以下**两个条件**，就**必定收敛**：

1. **uₙ 单调递减** (或者说 uₙ₊₁ ≤ uₙ)
    
    - **直观理解：** “后退”的步子比“前进”的步子要小。这样才能保证总体趋势是向前的，或者说不会发散到无穷。1 - 2 + 3 - 4... 这种后退比前进还多的，肯定不行。
        
2. **lim (n→∞) uₙ = 0**
    
    - **直观理解：** 每一步（不管是前进还是后退）的大小，最终都必须趋于0。如果走到无穷远处，你还在大幅度地来回跳，那你永远也稳定不下来。
        

**只要同时满足这两点，级数就收敛。**

---

### 绝对/条件收敛

1. 绝对收敛 (Absolutely Convergent)

	定义： 如果一个级数，给它每一项加上绝对值后得到的正项级数 ∑ |uₙ| 是收敛的，那么我们称原级数 ∑ uₙ 绝对收敛。
	
	直观理解： 这种收敛非常“强劲”，非常“稳定”。它根本不依赖正负号的抵消，就算所有项都朝一个方向使劲（全取绝对值），它的和都“炸”不了，那它自己（有正有负）当然更不可能“炸”了。
	
	重要定理： 绝对收敛的级数必定收敛。 (这个很好理解，自己不爆炸，有正负抵消更不会爆炸)
	
	例子： ∑ (-1)ⁿ⁻¹ / n² = 1 - 1/4 + 1/9 - ...
	取绝对值后得到 ∑ 1/n²，这是一个 p-级数且 p=2>1，收敛。
	所以，原级数 ∑ (-1)ⁿ⁻¹ / n² 是绝对收敛的。

2. 条件收敛 (Conditionally Convergent)

	定义： 如果一个级数 ∑ uₙ 自身收敛，但是取绝对值后的级数 ∑ |uₙ| 发散，那么我们称原级数 条件收敛。
	
	直观理解： 这种收敛是“脆弱”的，是“有条件的”。它的收敛完全依赖于正负项的相互抵消。一旦你破坏了这个抵消（取绝对值），它自己就扛不住了，会立刻发散。
	
	经典例子： 我们刚才分析的交错调和级数 ∑ (-1)ⁿ⁻¹ / n。
	它自身用莱布尼茨判别法判断是收敛的。
	取绝对值后得到调和级数 ∑ 1/n，是发散的。
	所以，∑ (-1)ⁿ⁻¹ / n 是条件收敛的。

**题目：** 判断级数 ∑ (-1)ⁿ (n / (n² + 1)) 的敛散性。

**解：**

**第一步：判断绝对收敛性。**  
我们考察其绝对值级数 ∑ |(-1)ⁿ (n / (n² + 1))| = ∑ n / (n² + 1)。  
使用比较判别法的极限形式，选取标杆级数 ∑ 1/n。  
因为 lim (n→∞) [n / (n² + 1)] / [1/n] = 1，且 ∑ 1/n 发散，  
所以级数 ∑ n / (n² + 1) **发散**。  
**结论：** 原级数**不**绝对收敛。

**第二步：判断条件收敛性。**  
既然不绝对收敛，我们就用莱布尼茨判别法来判断原交错级数 ∑ (-1)ⁿ (n / (n² + 1)) 的敛散性。

1. 令 uₙ = n / (n² + 1)。  
    lim (n→∞) uₙ = lim (n→∞) n / (n² + 1) = 0。**条件1满足。**
    
2. 考察函数 f(x) = x / (x² + 1) 的单调性。  
    f'(x) = ( (x² + 1) - x * 2x ) / (x² + 1)² = (1 - x²) / (x² + 1)²。  
    当 x > 1 时，f'(x) < 0，所以函数单调递减。  
    因此，数列 {uₙ} 从 n=2 开始单调递减。**条件2满足。**  
    **结论：** 根据莱布尼茨判别法，原交错级数 **收敛**。
    

**第三步：最终总结。**  
因为原级数 ∑ (-1)ⁿ (n / (n² + 1)) 收敛，但其绝对值级数 ∑ n / (n² + 1) 发散，  
所以，该级数是 **条件收敛** 的。

---

## 幂级数

**幂级数**是函数项级数中最简单、最重要的一种。它的每一项都是系数 x 的幂次方的形式。  
它的标准样子长这样：  
∑ aₙxⁿ = a₀ + a₁x + a₂x² + a₃x³ + ...  
（这里 aₙ 是一串常数，叫作系数）

**例子：**

- ∑ xⁿ = 1 + x + x² + x³ + ... (这里所有 aₙ = 1)
    
- ∑ xⁿ/n! = 1 + x/1! + x²/2! + x³/3! + ... (这里 aₙ = 1/n!)

---

### 收敛域、收敛半径

对于幂级数，我们的核心问题变成了：  
**“对于哪些 x，这个幂级数是收敛的？”**

所有能使幂级数收敛的 x 的集合，我们称之为幂级数的 **收敛域 (Interval of Convergence)**。  
求解收敛域，是幂级数这一章最最基本的计算题。

对于任何一个幂级数 ∑ aₙxⁿ，它的收敛域总会是下面三种情况之一：

1. **仅在 x=0 这一点收敛**。此时收敛域是 {0}。
    
2. **在整个实数轴 (-∞, +∞) 上都收敛**。
    
3. **存在一个正数 R**，使得：
    
    - 当 |x| < R (即 -R < x < R) 时，级数 **绝对收敛**。
        
    - 当 |x| > R (即 x > R 或 x < -R) 时，级数 **发散**。
        
    - 当 |x| = R (即 x = R 或 x = -R) 时，敛散性**不确定**，需要我们**单独代入端点值进行判断**。
        

这个神奇的数字 R，就叫做 **收敛半径 (Radius of Convergence)**。它就像在数轴上以原点为中心，画了一个半径为 R 的“安全地带”，只要 x 在这个开区间 (-R, R) 内部，级数就必定收敛。

- 对于情况1，我们可以认为 R=0。
    
- 对于情况2，我们可以认为 R=+∞。
    

**我们的任务就是：给定一个幂级数，求出它的收敛半径 R 和完整的收敛域。**

---

**收敛半径 R 的计算公式：**

- **比值法公式：** R = lim (n→∞) |aₙ / aₙ₊₁| (注意，这里是 aₙ/aₙ₊₁，正好是上面推导的倒数)
    
- **根值法公式：** R = 1 / (lim (n→∞) ⁿ√|aₙ|)
    

在实际做题时，用比值法公式更常见。

**完整解题步骤：三步走**

**第一步：求收敛半径 R**

1. **找出系数 aₙ
    
2. **计算 aₙ₊₁**
    
3. **套用比值法公式：**  
    R = lim (n→∞) |aₙ / aₙ₊₁|  

**第二步：确定开区间收敛域**

**第三步：单独判断端点 x=R 和 x=-R**

- 我们需要把它们**代回原级数**，把它变回我们熟悉的常数项级数来判断。

---

### **泰勒级数**

**泰勒公式**：  
f(x) = f(x₀) + f'(x₀)(x-x₀) + (f''(x₀)/2!)(x-x₀)² + ... + (f⁽ⁿ⁾(x₀)/n!)(x-x₀)ⁿ + ...

用求和符号写出来就是：  
f(x) = ∑ (f⁽ⁿ⁾(x₀) / n!) * (x - x₀)ⁿ (n从0到∞)

这是一个在 x₀ 点展开的泰勒级数。

当展开点 x₀ = 0 时，这个公式会变得特别简洁漂亮，为了纪念数学家麦克劳林，我们给它起了个专门的名字：**麦克劳林公式 (Maclaurin Series)**。  
f(x) = f(0) + f'(0)x + (f''(0)/2!)x² + ... + (f⁽ⁿ⁾(0)/n!)xⁿ + ...

f(x) = ∑ (f⁽ⁿ⁾(0) / n!) * xⁿ (n从0到∞)

**这就是我们“凭空”写出函数幂级数的魔法咒语！**  
只要一个函数在 x=0 点足够好（无限可导），我们就可以通过：

1. 求出它在 x=0 点的所有阶的导数。
    
2. 找到这些导数值的规律。
    
3. 套进麦克劳林公式。  
    来得到它的幂级数展开式。

---

### 运算

对幂级数进行这些运算，**几乎和对普通的多项式进行运算一模一样！**

请你始终在脑海里保持这个核心思想：**“幂级数，就是一个无限长的多项式。”**
有了这个概念，接下来的所有运算规则都会变得非常自然。

---

#### 1. 加法与减法 

假设我们有两个幂级数：
`f(x) = ∑ aₙxⁿ` (收敛半径为 `R₁`)
`g(x) = ∑ bₙxⁿ` (收敛半径为 `R₂`)

**规则：**
就像合并同类项一样，我们把 `xⁿ` 的系数直接相加或相减。
`f(x) ± g(x) = ∑ (aₙ ± bₙ)xⁿ`

**收敛性：**
这个新级数能在哪里工作呢？必须是 `f(x)` 和 `g(x)` **都能**工作的地方。所以，新的收敛半径是原来两个中**较小**的那一个。
`R = min(R₁, R₂)`

---

#### 2. 乘法

**规则：**
也和多项式乘法一样，展开后合并同类项。
`(a₀ + a₁x + a₂x² + ...)(b₀ + b₁x + b₂x² + ...)`
`= a₀b₀ + (a₀b₁ + a₁b₀)x + (a₀b₂ + a₁b₁ + a₂b₀)x² + ...`
这个过程比较繁琐，我们一般不直接用它来计算，但要理解这个原理。

**收敛性：**
和加减法一样，`R = min(R₁, R₂)`。

---

#### 3. 逐项求导与逐项积分

**定理：** 在收敛域的**内部**（即开区间 `(-R, R)` 内），幂级数可以像多项式一样，**逐项进行求导和积分**。

**最神奇的一点：**
**对幂级数进行逐项求导或逐项积分，它的收敛半径 `R` 不变！**
(注意：端点处的敛散性可能会改变，需要重新判断)

 **逐项求导 (Term-by-Term Differentiation)**

**规则：**
`d/dx (∑ aₙxⁿ) = ∑ d/dx (aₙxⁿ) = ∑ n*aₙ*xⁿ⁻¹`

**例子1：** 验证 `(sin(x))' = cos(x)`
`sin(x) = x - x³/3! + x⁵/5! - x⁷/7! + ...`
两边同时求导：
`d/dx(sin(x)) = d/dx(x) - d/dx(x³/3!) + d/dx(x⁵/5!) - ...`
`cos(x) = 1 - 3x²/3! + 5x⁴/5! - 7x⁶/7! + ...`
`= 1 - x²/2! + x⁴/4! - x⁶/6! + ...`
这正是我们之前得到的 `cos(x)` 的展开式！完美匹配！

 **逐项积分 (Term-by-Term Integration)**

**规则：**
`∫ (∑ aₙxⁿ) dx = ∑ (∫ aₙxⁿ dx) = C + ∑ aₙ * (xⁿ⁺¹ / (n+1))`
**千万别忘了积分常数 C！**

**例子2：** 求 `f(x) = ln(1+x)` 的麦克劳林展开式。
直接求 `ln(1+x)` 的各阶导数会很麻烦。但我们知道 `(ln(1+x))' = 1/(1+x)`。
我们可以从 `1/(1+x)` 出发，通过积分来得到 `ln(1+x)`。

**第一步：写出 `1/(1+x)` 的展开式。**
我们知道几何级数公式： `1/(1-t) = 1 + t + t² + t³ + ...`  (收敛半径 `R=1`)
令 `t = -x`，就得到：
`1/(1+x) = 1 - x + x² - x³ + x⁴ - ...` (收敛半径仍然是 `R=1`)

**第二步：两边同时积分。**
`∫ (1/(1+x)) dx = ∫ (1 - x + x² - x³ + x⁴ - ...) dx`
`ln(1+x) = C + (x - x²/2 + x³/3 - x⁴/4 + x⁵/5 - ...)`

**第三步：确定积分常数 `C`。**
我们知道这个等式在收敛域 `(-1, 1)` 内成立。我们取一个最简单的点 `x=0` 代入。
`ln(1+0) = C + (0 - 0 + 0 - ...)`
`ln(1) = C`
`0 = C`
所以积分常数 `C` 是 0。

**结论（第四个必须背下来的展开式）：**
`ln(1+x) = x - x²/2 + x³/3 - x⁴/4 + ... = ∑ (-1)ⁿ⁻¹ * xⁿ/n` (n从1到∞)
它的收敛半径和 `1/(1+x)` 一样，`R=1`。

---

#### **应用：求幂级数的和函数**

这些运算最强大的应用之一，就是反过来，给我们一个不熟悉的级数，让我们求出它收敛起来等于哪个函数（我们称之为“和函数”）。

**例题：** 求和函数 `S(x) = ∑ nxⁿ` (n从1到∞)

**分析：**
这个级数 `x + 2x² + 3x³ + ...` 看着很陌生。但是，`nxⁿ` 这个形式，让我们联想到求导。
`xⁿ` 求导是 `nxⁿ⁻¹`，和它很像。
我们把它变形一下：
`S(x) = x * (∑ nxⁿ⁻¹)`

括号里的 `∑ nxⁿ⁻¹ = 1 + 2x + 3x² + ...` 是不是看着很眼熟？
它就是我们熟悉的几何级数 `f(x) = ∑ xⁿ = 1/(1-x)` 求导的结果！
`f'(x) = d/dx (∑ xⁿ) = ∑ nxⁿ⁻¹`
而 `f'(x) = d/dx (1/(1-x)) = 1/(1-x)²`
所以，`∑ nxⁿ⁻¹ = 1/(1-x)²`。

代回原式：
`S(x) = x * (∑ nxⁿ⁻¹) = x * (1/(1-x)²) = x / (1-x)²`

当拿到一个陌生的级数 S(x)，想求它的和函数时：

1. **第一眼：看通项。**
    
    - 看到 n 在分子（或作为系数），想到**求导**。
        
    - 看到 n 在分母，想到**积分**。
        
    - 看到 (某东西)ⁿ，想到**几何级数** 1/(1-t)，并进行**变量代换** t = (某东西)。
        
2. **第二步：找“原型”。**  
    根据第一步的观察，找到一个我们认识的、最接近它的“原型”级数。通常这个原型就是几何级数 ∑ xⁿ 或它的某个变量代换。
    
3. **第三步：动手操作。**  
    从“原型”级数出发，通过**求导、积分、乘除 x** 等操作，一步步地把“原型”变成我们想要的目标 S(x)。  
    在这个过程中，你要对“原型”的**函数形式**（比如 1/(1-x)）和**级数形式**（比如 ∑ xⁿ）**同时进行操作**。
    
4. **第四步：得出结果。**  
    最终，等式的一边是我们的目标 S(x)，另一边就是一个具体的函数表达式。

---
#### 重要级数展开

几何级数（最重要！）

$1/(1-x) = \sum x^n = 1 + x + x^2 + ...$ (收敛域 $|x|<1$)

对数函数（由几何级数积分而来）

$ln(1+x) = \sum (-1)^{n-1} * x^n/n = x - x^2/2 + x^3/3 - ...$ (收敛域 $(-1, 1]$)

指数函数
 
$e^x = \sum x^n/n! = 1 + x + x^2/2! + ...$ (收敛域 $(-\infty, +\infty)$)

三角函数

$sin(x) = \sum (-1)^{n-1} * x^{2n-1}/(2n-1)! = x - x^3/3! + ...$

$cos(x) = \sum (-1)^n * x^{2n}/(2n)! = 1 - x^2/2! + ...$

| 函数              | 展开式                          | 收敛域       |
| :-------------- | :--------------------------- | :-------- |
| **`1/(1-x)`**   | `Σ xⁿ`                       | `(-1, 1)` |
| **`e^x`**       | `Σ xⁿ / n!`                  | `(-∞, ∞)` |
| **`sin(x)`**    | `Σ (-1)ⁿ x^(2n+1) / (2n+1)!` | `(-∞, ∞)` |
| **`cos(x)`**    | `Σ (-1)ⁿ x^(2n) / (2n)!`     | `(-∞, ∞)` |
| **`ln(1+x)`**   | `Σ (-1)ⁿ⁻¹ xⁿ / n`           | `(-1, 1]` |
| **`arctan(x)`** | `Σ (-1)ⁿ x^(2n+1) / (2n+1)`  | `[-1, 1]` |
| **`(1+x)^α`**   | `1 + αx + ...` (二项式级数)       | `(-1, 1)` |
| **`sinh(x)`**   | `Σ x^(2n+1) / (2n+1)!`       | `(-∞, ∞)` |
| **`cosh(x)`**   | `Σ x^(2n) / (2n)!`           | `(-∞, ∞)` |

---
